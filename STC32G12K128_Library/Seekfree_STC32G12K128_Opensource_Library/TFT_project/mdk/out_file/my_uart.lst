C251 COMPILER V5.60.0,  my_uart                                                            12/11/25  22:24:45  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE my_uart
OBJECT MODULE PLACED IN .\out_file\my_uart.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\code\my_uart.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BRO
                    -WSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;.
                    -.\user;..\code;..\Hardware) DEBUG PRINT(.\out_file\my_uart.lst) OBJECT(.\out_file\my_uart.obj) 

stmt  level    source

    1          #include "my_uart.h"
    2          
    3          uint8       uart_get_data[64] = {0};                                                  // ä¸²å£æ¥æ”¶æ•°æ
             -®ç¼“å†²åŒº
    4          uint8       fifo_get_data[64] = {0};                                                 // fifo è¾“å‡ºè¯»å‡º
             -ç¼“å†²åŒº
    5          
    6          
    7          uint32      fifo_data_count = 0;                                                // fifo æ•°æ®ä¸ªæ•°
    8          
    9          fifo_struct uart_data_fifo = {0};
   10          
   11          void uart_rx_interrupt_handler (uint8 dat)
   12          {
   13   1      //    get_data = uart_read_byte(UART_INDEX);                                      // æ¥æ”¶æ•°æ® while ç
             -­‰å¾…å¼ ä¸å»ºè®®åœ¨ä¸­æ–­ä½¿ç”¨
   14   1          uart_query_byte(UART_INDEX, &dat);                                     // æ¥æ”¶æ•°æ® æŸ¥è¯¢å¼ æœ‰æ
             -•°æ®ä¼šè¿”å› TRUE æ²¡æœ‰æ•°æ®ä¼šè¿”å› FALSE
   15   1          fifo_write_buffer(&uart_data_fifo, &dat, 1);                           // å°†æ•°æ®å†™å…¥ fifo ä¸­
   16   1      }
   17          
   18          
   19          void self_UART_init()
   20          {
   21   1          fifo_init(&uart_data_fifo, FIFO_DATA_8BIT, uart_get_data, 64);              // åˆå§‹åŒ– fifo æŒ‚è½½ç
             -¼“å†²åŒº
   22   1      
   23   1          uart_init(UART_INDEX, UART_BAUDRATE, UART_TX_PIN, UART_RX_PIN);             // åˆå§‹åŒ–ä¸²å£
   24   1          
   25   1              // UART1çš„ä¸­æ–­ä¼˜å…ˆçº§ä¸èƒ½è®¾ç½®ï¼Œä¸ºæœ€ä½ä¼˜å…ˆçº§å€¼0
   26   1              uart_rx_interrupt(UART_INDEX, ZF_ENABLE);                                   // å¼€å¯ UART_INDEX çš„æ¥æ
             -”¶ä¸­æ–­
   27   1          
   28   1      
   29   1              // è®¾ç½®ä¸­æ–­å›è°ƒå‡½æ•°
   30   1              uart1_irq_handler = uart_rx_interrupt_handler;
   31   1              
   32   1              
   33   1              uart_write_string(UART_INDEX, "UART Text.");                                // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
   34   1          uart_write_byte(UART_INDEX, '\r');                                          // è¾“å‡ºå›è½¦
   35   1          uart_write_byte(UART_INDEX, '\n');                                          // è¾“å‡ºæ¢è¡Œ
   36   1      
   37   1      }
   38          
   39          void self_UART_process()
   40          {
   41   1              // fifo_data_count = fifo_used(&uart_data_fifo);                           // æŸ¥çœ‹ fifo æ˜¯å¦æ
             -œ‰æ•°æ®
   42   1              // if(fifo_data_count != 0)                                                // è¯»å–åˆ°æ•°æ®äº†
   43   1              // {
   44   1              //    fifo_read_buffer(&uart_data_fifo, fifo_get_data, &fifo_data_count, FIFO_READ_AND_CLEAN);   
             - // å°† fifo ä¸­æ•°æ®è¯»å‡ºå¹¶æ¸…ç©º fifo æŒ‚è½½çš„ç¼“å†²
   45   1              //    uart_write_string(UART_INDEX, "UART get data:");                     // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
   46   1              //    uart_write_buffer(UART_INDEX, fifo_get_data, (uint16)fifo_data_count);       // å°†è¯»å–åˆ
             -°çš„æ•°æ®å‘é€å‡ºå»
   47   1              //    uart_write_string(UART_INDEX, "\r\n");                               // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
   48   1              // }
C251 COMPILER V5.60.0,  my_uart                                                            12/11/25  22:24:45  PAGE 2   

   49   1              uint32 time=0;
   50   1      
   51   1              time=pit_read();
   52   1              printf("the time now is:%d",time);
   53   1              printf("\r\n");
   54   1      
   55   1              system_delay_ms(1000);
   56   1              // æ­¤å¤„ç¼–å†™éœ€è¦å¾ªç¯æ‰§è¡Œçš„
   57   1      }
   58          
*** WARNING C183 IN LINE 49 OF ..\code\my_uart.c: dead assignment eliminated


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       208     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =       155          1
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =       208     ------
End of Module Information.


C251 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
