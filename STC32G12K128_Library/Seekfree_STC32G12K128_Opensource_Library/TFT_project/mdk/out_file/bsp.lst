C251 COMPILER V5.60.0,  bsp                                                                12/11/25  22:24:45  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE bsp
OBJECT MODULE PLACED IN .\out_file\bsp.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\code\bsp.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BROWSE 
                    -INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;..\us
                    -er;..\code;..\Hardware) DEBUG PRINT(.\out_file\bsp.lst) OBJECT(.\out_file\bsp.obj) 

stmt  level    source

    1          #include "bsp.h"
    2          
    3          
    4          uint8 task_num=0;
    5          
    6          typedef struct scheduler
    7          {
    8              void(*task_func)(void);
    9              uint32 rate_ms;
   10              uint32 last_run;
   11          }scheduler_task_t;
   12          
   13          static scheduler_task_t scheduler_task[]={
   14            {led_process,1,0},
   15            {self_UART_process,10,0},
   16          };
   17          
   18          //初始化
   19          void scheduler_Init(void)
   20          {
   21   1          task_num=sizeof(scheduler_task)/sizeof(scheduler_task_t);
   22   1      }
   23          
   24          void all_init(void)
   25          {
   26   1          //底层初始化
   27   1          clock_init(SYSTEM_CLOCK_30M);
   28   1              debug_init();
   29   1          scheduler_Init();
   30   1          //用户初始化
   31   1          self_pit_init();
   32   1          self_UART_init();
   33   1      }
   34          
   35          
   36          //执行任务表
   37             //hal_tick函数不更新容易卡
   38          
   39          void scheduler_run(void)
   40          {
   41   1          int i;
   42   1          for(i=0;i<task_num;i++)
   43   1          {
   44   2            uint32 Now_Time=pit_read();
   45   2              
   46   2              if(Now_Time>=scheduler_task[i].rate_ms+scheduler_task[i].last_run)
   47   2              {
   48   3                  scheduler_task[i].last_run=Now_Time;
   49   3                  //更新最后时间
   50   3                  scheduler_task[i].task_func();
   51   3                  //执行相应代码
   52   3              }
   53   2          }
   54   1      }


Module Information          Static   Overlayable
------------------------------------------------
C251 COMPILER V5.60.0,  bsp                                                                12/11/25  22:24:45  PAGE 2   

  code size            =       158     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =        21          4
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        31     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
