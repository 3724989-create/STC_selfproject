C251 COMPILER V5.60.0,  my_uart                                                            18/11/25  17:04:56  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE my_uart
OBJECT MODULE PLACED IN .\out_file\my_uart.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\code\my_uart.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BRO
                    -WSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;.
                    -.\user;..\code;..\Hardware) DEBUG PRINT(.\out_file\my_uart.lst) OBJECT(.\out_file\my_uart.obj) 

stmt  level    source

    1          #include "my_uart.h"
    2          
    3          uint8       uart_get_data[64] = {0};                                                  // ä¸²å£æ¥æ”¶æ•°æ
             -®ç¼“å†²åŒº
    4          uint8       fifo_get_data[64] = {0};                                                 // fifo è¾“å‡ºè¯»å‡º
             -ç¼“å†²åŒº
    5          
    6          
    7          uint32      fifo_data_count = 0;                                                // fifo æ•°æ®ä¸ªæ•°
    8          
    9          fifo_struct uart_data_fifo = {0};
   10          
   11          // é‡å®šå‘ printf åˆ°ä¸²å£
   12          
   13           void uart_rx_interrupt_handler (uint8 dat)
   14           {
   15   1       //    get_data = uart_read_byte(UART_INDEX);                                      // æ¥æ”¶æ•°æ® while 
             -ç­‰å¾…å¼ ä¸å»ºè®®åœ¨ä¸­æ–­ä½¿ç”¨
   16   1           uart_query_byte(UART_INDEX, &dat);                                     // æ¥æ”¶æ•°æ® æŸ¥è¯¢å¼ æœ‰
             -æ•°æ®ä¼šè¿”å› TRUE æ²¡æœ‰æ•°æ®ä¼šè¿”å› FALSE
   17   1           fifo_write_buffer(&uart_data_fifo, &dat, 1);                           // å°†æ•°æ®å†™å…¥ fifo ä¸­
   18   1       }
   19          
   20          void self_UART_init()
   21          {
   22   1          fifo_init(&uart_data_fifo, FIFO_DATA_8BIT, uart_get_data, 64);              // åˆå§‹åŒ– fifo æŒ‚è½½ç
             -¼“å†²åŒº
   23   1      
   24   1          uart_init(UART_INDEX, UART_BAUDRATE, UART_TX_PIN, UART_RX_PIN);             // åˆå§‹åŒ–ä¸²å£
   25   1          
   26   1              // UART1çš„ä¸­æ–­ä¼˜å…ˆçº§ä¸èƒ½è®¾ç½®ï¼Œä¸ºæœ€ä½ä¼˜å…ˆçº§å€¼0
   27   1              uart_rx_interrupt(UART_INDEX, ZF_ENABLE);                                   // å¼€å¯ UART_INDEX çš„æ¥æ
             -”¶ä¸­æ–­
   28   1          
   29   1      
   30   1              // è®¾ç½®ä¸­æ–­å›è°ƒå‡½æ•°
   31   1              uart1_irq_handler = uart_rx_interrupt_handler;
   32   1              
   33   1              
   34   1              uart_write_string(UART_INDEX, "UART Text.");                                // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
   35   1          uart_write_byte(UART_INDEX, '\r');                                          // è¾“å‡ºå›è½¦
   36   1          uart_write_byte(UART_INDEX, '\n');                                          // è¾“å‡ºæ¢è¡Œ
   37   1      
   38   1      }
   39          
   40          void self_UART_process()
   41          {
   42   1               fifo_data_count = fifo_used(&uart_data_fifo);                           // æŸ¥çœ‹ fifo æ˜¯å¦æœ‰
             -æ•°æ®
   43   1               if(fifo_data_count != 0)                                                // è¯»å–åˆ°æ•°æ®äº†
   44   1               {
   45   2                  fifo_read_buffer(&uart_data_fifo, fifo_get_data, &fifo_data_count, FIFO_READ_AND_CLEAN);    /
             -/ å°† fifo ä¸­æ•°æ®è¯»å‡ºå¹¶æ¸…ç©º fifo æŒ‚è½½çš„ç¼“å†²
   46   2                  uart_write_string(UART_INDEX, "UART get data:");                     // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
   47   2                  uart_write_buffer(UART_INDEX, fifo_get_data, (uint16)fifo_data_count);       // å°†è¯»å–åˆ°ç
             -š„æ•°æ®å‘é€å‡ºå»
   48   2                  uart_write_string(UART_INDEX, "\r\n");                               // è¾“å‡ºæµ‹è¯•ä¿¡æ¯
C251 COMPILER V5.60.0,  my_uart                                                            18/11/25  17:04:56  PAGE 2   

   49   2               }
   50   1               
   51   1      }
   52          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       295     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =       155          1
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =       204     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
