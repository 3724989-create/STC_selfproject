C251 COMPILER V5.60.0,  bsp                                                                18/11/25  17:04:56  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE bsp
OBJECT MODULE PLACED IN .\out_file\bsp.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\code\bsp.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BROWSE 
                    -INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;..\us
                    -er;..\code;..\Hardware) DEBUG PRINT(.\out_file\bsp.lst) OBJECT(.\out_file\bsp.obj) 

stmt  level    source

    1          #include "bsp.h"
    2          
    3          
    4          uint8 task_num=0;
    5          
    6          typedef struct scheduler
    7          {
    8              void(*task_func)(void);
    9              uint32 rate_ms;
   10              uint32 last_run;
   11          }scheduler_task_t;
   12          
   13          static scheduler_task_t scheduler_task[]={
   14            {led_process,1,0},
   15            {self_UART_process,10,0},
   16            {Servo_test_Process,10,0},
   17          };
   18          
   19          //初始化
   20          void scheduler_Init(void)
   21          {
   22   1          task_num=sizeof(scheduler_task)/sizeof(scheduler_task_t);
   23   1      }
   24          
   25          void all_init(void)
   26          {
   27   1          //底层初始化
   28   1          clock_init(SYSTEM_CLOCK_30M);
   29   1              debug_init();
   30   1          scheduler_Init();
   31   1          //用户初始化
   32   1          self_pit_init();
   33   1          self_UART_init();
   34   1          IIC_intit();
   35   1          Servo_init();
   36   1      }
   37          
   38          
   39          //执行任务表
   40             //hal_tick函数不更新容易卡
   41          
   42          void scheduler_run(void)
   43          {
   44   1          int i;
   45   1          for(i=0;i<task_num;i++)
   46   1          {
   47   2            uint32 Now_Time=pit_read();
   48   2              
   49   2              if(Now_Time>=scheduler_task[i].rate_ms+scheduler_task[i].last_run)
   50   2              {
   51   3                  scheduler_task[i].last_run=Now_Time;
   52   3                  //更新最后时间
   53   3                  scheduler_task[i].task_func();
   54   3                  //执行相应代码
   55   3              }
   56   2          }
   57   1      }
C251 COMPILER V5.60.0,  bsp                                                                18/11/25  17:04:56  PAGE 2   



Module Information          Static   Overlayable
------------------------------------------------
  code size            =       164     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =        31          4
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        41     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
