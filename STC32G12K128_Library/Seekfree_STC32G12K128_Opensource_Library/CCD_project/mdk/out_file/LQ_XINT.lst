C251 COMPILER V5.60.0,  LQ_XINT                                                            18/11/25  13:07:53  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE LQ_XINT
OBJECT MODULE PLACED IN .\out_file\LQ_XINT.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\lq_libraries\LQ_LIB\Src\LQ_XINT.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3)
                    - OPTIMIZE(SIZE) BROWSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\li
                    -braries\zf_driver;..\user;..\code;..\Hardware;..\lq_libraries\LQ_LIB\Inc;..\lq_libraries\Include;..\lq_libraries\Driver\
                    -Inc) DEBUG PRINT(.\out_file\LQ_XINT.lst) OBJECT(.\out_file\LQ_XINT.obj) 

stmt  level    source

    1          /*LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
    2           ¡¾Æ½    Ì¨¡¿±±¾©ÁúÇñÖÇÄÜ¿Æ¼¼STC32Î»ºËÐÄ°å
    3           ¡¾±à    Ð´¡¿ÁúÇñ¿Æ¼¼
    4           ¡¾E-mail  ¡¿chiusir@163.com
    5           ¡¾Èí¼þ°æ±¾¡¿V1.0 °æÈ¨ËùÓÐ£¬µ¥Î»Ê¹ÓÃÇëÏÈÁªÏµÊÚÈ¨
    6           ¡¾Ïà¹ØÐÅÏ¢²Î¿¼ÏÂÁÐµØÖ·¡¿
    7           ¡¾Íø    Õ¾¡¿http://www.lqist.cn
    8           ¡¾ÌÔ±¦µêÆÌ¡¿http://longqiu.taobao.com
    9           --------------------------------------------------------------------------------
   10           ¡¾  IDE  ¡¿ keil C251 V5.60
   11           ¡¾Target ¡¿ STC32G/STC8051U/AI8051U 32Î»Ä£Ê½
   12           ¡¾SYS CLK¡¿ 42 MHzÊ¹ÓÃÄÚ²¿¾§Õñ
   13          QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ*/
   14          #include "include.h"
   15          
   16          
   17          /***********************************************************************************
   18           * º¯ Êý Ãû£ºvoid Exti_Init(void)
   19           * ¹¦    ÄÜ£ºSTC´«Í³Íâ²¿ÖÐ¶Ï³õÊ¼»¯£¬¹Ü½Å³õÊ¼»¯ºÍÖÐ¶ÏÄ£Ê½¡¢Ê¹ÄÜµÈÉèÖÃ
   20           * ²Î    Êý£ºEXT_INTx£¬Íâ²¿ÖÐ¶ÏºÅ
   21           * ·µ »Ø Öµ£ºÎÞ
   22           * Ëµ    Ã÷£ºINT½ÅÎ»ÓÚP3¿Ú£ºINTO:P3.2,INT1:P3.3,INT2:P3.6,INT3:P3.7,INT4:P3.0
   23           *           INT2¡¢INT2¡¢INT4½öÖ§³ÖÏÂ½µÑØ´¥·¢ÖÐ¶Ï
   24           **********************************************************************************/
   25          void Exti_Init(u8 EXT_INTx)
   26          {
   27   1              EXTI_InitTypeDef        Exti_InitStructure;             //½á¹¹¶¨Òå
   28   1          //ÖÐ¶ÏIOÅäÖÃ
   29   1          switch(EXT_INTx)
   30   1          {
   31   2              case EXT_INT0:
   32   2              {
   33   3                  //INT0ÖÐ¶Ï¹Ü½ÅÉèÖÃ
   34   3                  P3_MODE_IO_PU(GPIO_Pin_2);                      //P3.2 ÉèÖÃÎª×¼Ë«Ïò¿Ú
   35   3                  P3_PULL_UP_ENABLE(GPIO_Pin_2);                  //P3.2 ¿ÚÄÚ²¿ÉÏÀ­µç×èÊ¹ÄÜ
   36   3                  //ÖÐ¶ÏÄ£Ê½³õÊ¼»¯ÅäÖÃ
   37   3                  Exti_InitStructure.EXTI_Mode = EXT_MODE_Fall;   //ÖÐ¶ÏÄ£Ê½ÉèÎªÏÂ½µÑØ´¥·¢, EXT_MODE_RiseFall,E
             -XT_MODE_Fall
   38   3                  Ext_Inilize(EXT_INT0,&Exti_InitStructure);      //³õÊ¼»¯£¬EXT_INT0Á¬½ÓÍâ²¿P3.2¹Ü½Å
   39   3                  NVIC_INT0_Init(ENABLE,Priority_0);              //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÓÅÏÈ¼¶(µÍµ½¸ß) Pr
             -iority_0,Priority_1,Priority_2,Priority_3
   40   3              //      NVIC_INT0_Init(ENABLE,NULL);                        //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÎÞÓÅÏÈ¼¶
   41   3              }break;
   42   2              case EXT_INT1:
   43   2              {
   44   3                  //INT1ÖÐ¶Ï¹Ü½ÅÉèÖÃ
   45   3                  P3_MODE_IO_PU(GPIO_Pin_3);                      //P3.3 ÉèÖÃÎª×¼Ë«Ïò¿Ú
   46   3                  P3_PULL_UP_ENABLE(GPIO_Pin_3);                  //P3.3 ¿ÚÄÚ²¿ÉÏÀ­µç×èÊ¹ÄÜ
   47   3                  //ÖÐ¶ÏÄ£Ê½³õÊ¼»¯ÅäÖÃ
   48   3                  Exti_InitStructure.EXTI_Mode = EXT_MODE_Fall;   //ÖÐ¶ÏÄ£Ê½ÉèÎªÏÂ½µÑØ´¥·¢, EXT_MODE_RiseFall,E
             -XT_MODE_Fall
   49   3                  Ext_Inilize(EXT_INT1,&Exti_InitStructure);      //³õÊ¼»¯£¬  EXT_INT1Á¬½ÓÍâ²¿P3.3¹Ü½Å
   50   3                  NVIC_INT1_Init(ENABLE,Priority_0);              //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÓÅÏÈ¼¶(µÍµ½¸ß) Pr
             -iority_0,Priority_1,Priority_2,Priority_3
   51   3              //      NVIC_INT1_Init(ENABLE,NULL);                    //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÎÞÓÅÏÈ¼¶
   52   3              }break;
C251 COMPILER V5.60.0,  LQ_XINT                                                            18/11/25  13:07:53  PAGE 2   

   53   2              case EXT_INT2:
   54   2              {
   55   3                  //INT1ÖÐ¶Ï¹Ü½ÅÉèÖÃ
   56   3                  P3_MODE_IO_PU(GPIO_Pin_6);                      //P3.6 ÉèÖÃÎª×¼Ë«Ïò¿Ú
   57   3                  P3_PULL_UP_ENABLE(GPIO_Pin_6);                  //P3.6 ¿ÚÄÚ²¿ÉÏÀ­µç×èÊ¹ÄÜ
   58   3                  //ÖÐ¶Ï³õÊ¼»¯ÅäÖÃ
   59   3                  Ext_Inilize(EXT_INT2,&Exti_InitStructure);      //½ö½øÈëº¯ÊýÇå±êÖ¾Î»£¬Ê¹ÄÜ£¬Ä¬ÈÏÏÂ½µÑØ´¥·¢£¬Ó
             -Ã»§²»¿ÉÅäÖÃ
   60   3                  NVIC_INT2_Init(ENABLE,Priority_0);              //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÓÅÏÈ¼¶(µÍµ½¸ß) Pr
             -iority_0,Priority_1,Priority_2,Priority_3
   61   3              //      NVIC_INT2_Init(ENABLE,NULL);                        //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÎÞÓÅÏÈ¼¶
   62   3              }break;
   63   2              case EXT_INT3:
   64   2              {
   65   3                  //INT1ÖÐ¶Ï¹Ü½ÅÉèÖÃ
   66   3                  P3_MODE_IO_PU(GPIO_Pin_7);                      //P3.6 ÉèÖÃÎª×¼Ë«Ïò¿Ú
   67   3                  P3_PULL_UP_ENABLE(GPIO_Pin_7);                  //P3.6 ¿ÚÄÚ²¿ÉÏÀ­µç×èÊ¹ÄÜ
   68   3                  //ÖÐ¶Ï³õÊ¼»¯ÅäÖÃ
   69   3                  Ext_Inilize(EXT_INT3,&Exti_InitStructure);      //³õÊ¼»¯½ö½øÈëº¯ÊýÇå±êÖ¾Î»£¬Ê¹ÄÜ£¬Ä¬ÈÏÏÂ½µÑØ´
             -¥·¢£¬ÓÃ»§²»¿ÉÅäÖÃ
   70   3                  NVIC_INT3_Init(ENABLE,Priority_0);              //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÓÅÏÈ¼¶(µÍµ½¸ß) Pr
             -iority_0,Priority_1,Priority_2,Priority_3
   71   3              }break;
   72   2              case EXT_INT4:
   73   2              {
   74   3                  //INT1ÖÐ¶Ï¹Ü½ÅÉèÖÃ
   75   3                  P3_MODE_IO_PU(GPIO_Pin_0);                      //P3.0 ÉèÖÃÎª×¼Ë«Ïò¿Ú
   76   3                  P3_PULL_UP_ENABLE(GPIO_Pin_0);                  //P3.0 ¿ÚÄÚ²¿ÉÏÀ­µç×èÊ¹ÄÜ
   77   3                  //ÖÐ¶Ï³õÊ¼»¯ÅäÖÃ
   78   3                  Ext_Inilize(EXT_INT4,&Exti_InitStructure);      //³õÊ¼»¯½ö½øÈëº¯ÊýÇå±êÖ¾Î»£¬Ê¹ÄÜ£¬Ä¬ÈÏÏÂ½µÑØ´
             -¥·¢£¬ÓÃ»§²»¿ÉÅäÖÃ
   79   3                  NVIC_INT4_Init(ENABLE,Priority_0);              //ÖÐ¶ÏÊ¹ÄÜ, ENABLE/DISABLE; ÓÅÏÈ¼¶(µÍµ½¸ß) Pr
             -iority_0,Priority_1,Priority_2,Priority_3
   80   3              }break;
   81   2              default: //·Ç·¨×Ö¶Î
   82   2                  break;
   83   2          }
   84   1      }
   85          
   86          
   87          /***********************************************************************************
   88           * º¯ Êý Ãû£ºvoid Test_ExINT()
   89           * ¹¦    ÄÜ£ºSTC´«Í³Íâ²¿ÖÐ¶Ï²âÊÔº¯Êý£¬ÖÐ¶Ï·þÎñº¯ÊýÖÐLED0×´Ì¬
   90           * ²Î    Êý£ºÎÞ
   91           * ·µ »Ø Öµ£ºÎÞ
   92           * Ëµ    Ã÷£ºINT½ÅÎ»ÓÚP3¿Ú£ºINTO:P3.2,INT1:P3.3,INT2:P3.6,INT3:P3.7,INT4:P3.0
   93           *           INT2¡¢INT2¡¢INT4½öÖ§³ÖÏÂ½µÑØ´¥·¢ÖÐ¶Ï
   94           **********************************************************************************/
   95          void Test_ExINT()
   96          {
   97   1          GPIO_LED_Init();
   98   1          
   99   1          Exti_Init(EXT_INT1);    //³õÊ¼»¯Íâ²¿ÖÐ¶Ï1 ÇëÇ°Íù Íâ²¿ÖÐ¶Ï·þÎñº¯Êý£¬±àÐ´ÖÐ¶Ï·þÎñ³ÌÐò
  100   1          
  101   1          OLED_Init();
  102   1          OLED_CLS();                         // ÇåÆÁ
  103   1          OLED_P8x16Str(0,0, "Test EXINT ->P33");
  104   1          
  105   1          while(1)
  106   1          {
  107   2              ;
  108   2          }
  109   1      }
  110          
  111          
  112          
C251 COMPILER V5.60.0,  LQ_XINT                                                            18/11/25  13:07:53  PAGE 3   

  113          //----------------------- ÒÔÏÂÎª IOÖÐ¶Ï³õÊ¼»¯Ïà¹ØÄÚÈÝ £¬ËùÓÐ¹Ü½Å½Ô¿ÉÖÐ¶Ï-------------------------
  114          //  Ê¹ÓÃÊ±¿ÉÒÔ×¢ÊÍµôÓÃ²»µ½µÄ£¬½ÚÊ¡¿Õ¼ä£¬ÈôÊ±STC32G12K128ÔòÎÞÐèµ£ÐÄ¿Õ¼äÎÊÌâ
  115          
  116          
  117          /***********************************************************************************
  118           * º¯ Êý Ãû£ºu8 GPIO_INT_InitE(u8 GPIO, GPIO_InitTypeDef *GPIOx)
  119           * ¹¦    ÄÜ£º³õÊ¼»¯GPIO ¶Ë¿ÚÖÐ¶Ï,¾«È·µ½Ã¿¸öIO¿Ú£¬³õÊ¼»¯ºóÁ¢¼´Ê¹ÄÜ£¬eg: P0INTE  µÄ7¸öÎ»¶ÔÓ¦P0.0µ½P0.7
  120           * ²Î    Êý£ºGPIO¶Ë¿Ú£¬I/O½á¹¹Ìå£¨¹Ü½ÅºÍÖÐ¶ÏÄ£Ê½ÅäÖÃ£©
  121           * ·µ »Ø Öµ£ºÎÞ
  122           * Ê±    ¼ä£º2024-11-18
  123           * Èí¼þ°æ±¾£ºV1.0
  124           **********************************************************************************/
  125          u8 GPIO_INT_InitE(u8 GPIO, GPIO_InitTypeDef *GPIOx)
  126          {
  127   1              if(GPIO > GPIO_P7)      return FAIL;                    //´íÎó
  128   1              if(GPIOx->Mode > PxINT_MODE_HIGH)       return FAIL;    //´íÎó
  129   1              if(GPIO == GPIO_P0)
  130   1              {
  131   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P0IM1 &= ~(GPIOx->Pin),   P0IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  132   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P0IM1 &= ~(GPIOx->Pin),   P0IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
  133   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P0IM1 |=  (GPIOx->Pin),   P0IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  134   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P0IM1 |=  (GPIOx->Pin),   P0IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  135   2              P0_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  136   2              P0INTE |= GPIOx->Pin;        //Ê¹ÄÜP0.PinÖÐ¶Ï
  137   2          }
  138   1              if(GPIO == GPIO_P1)
  139   1              {
  140   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P1IM1 &= ~(GPIOx->Pin),   P1IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  141   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P1IM1 &= ~(GPIOx->Pin),   P1IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
  142   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P1IM1 |=  (GPIOx->Pin),   P1IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  143   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P1IM1 |=  (GPIOx->Pin),   P1IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  144   2              P1_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  145   2              P1INTE |= GPIOx->Pin;        //Ê¹ÄÜP1.PinÖÐ¶Ï
  146   2              }
  147   1              if(GPIO == GPIO_P2)
  148   1              {
  149   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P2IM1 &= ~(GPIOx->Pin),   P2IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  150   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P2IM1 &= ~(GPIOx->Pin),   P2IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
  151   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P2IM1 |=  (GPIOx->Pin),   P2IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  152   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P2IM1 |=  (GPIOx->Pin),   P2IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  153   2              P2_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  154   2              P2INTE |= GPIOx->Pin;        //Ê¹ÄÜP2.PinÖÐ¶Ï
  155   2              }
  156   1              if(GPIO == GPIO_P3)
  157   1              {
  158   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P3IM1 &= ~(GPIOx->Pin),   P3IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  159   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P3IM1 &= ~(GPIOx->Pin),   P3IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
  160   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P3IM1 |=  (GPIOx->Pin),   P3IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  161   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P3IM1 |=  (GPIOx->Pin),   P3IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  162   2              P3_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  163   2              P3INTE |= GPIOx->Pin;        //Ê¹ÄÜP3.PinÖÐ¶Ï
  164   2              }
  165   1              if(GPIO == GPIO_P4)
  166   1              {
  167   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P4IM1 &= ~(GPIOx->Pin),   P4IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  168   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P4IM1 &= ~(GPIOx->Pin),   P4IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
  169   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P4IM1 |=  (GPIOx->Pin),   P4IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  170   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P4IM1 |=  (GPIOx->Pin),   P4IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  171   2              P4_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  172   2              P4INTE |= GPIOx->Pin;        //Ê¹ÄÜP4.PinÖÐ¶Ï
  173   2              }
  174   1              if(GPIO == GPIO_P5)
  175   1              {
  176   2      //        if(GPIOx->Pin > 6||GPIOx->Pin > 7) return FAIL;  //AI8051U Ã»ÓÐP5.6  P5.7
  177   2                      if(GPIOx->Mode == PxINT_MODE_Fall)              {P5IM1 &= ~(GPIOx->Pin),   P5IM0 &= ~(GPIOx->Pin);}      //ÏÂ½µÑØÖÐ¶Ï
  178   2                      if(GPIOx->Mode == PxINT_MODE_Rise)              {P5IM1 &= ~(GPIOx->Pin),   P5IM0 |=  (GPIOx->Pin);}      //ÉÏÉýÑØÖÐ¶Ï
C251 COMPILER V5.60.0,  LQ_XINT                                                            18/11/25  13:07:53  PAGE 4   

  179   2                      if(GPIOx->Mode == PxINT_MODE_LOW)               {P5IM1 |=  (GPIOx->Pin),   P5IM0 &= ~(GPIOx->Pin);}      //µÍµçÆ½ÖÐ¶Ï
  180   2                      if(GPIOx->Mode == PxINT_MODE_HIGH)              {P5IM1 |=  (GPIOx->Pin),   P5IM0 |=  (GPIOx->Pin);}      //¸ßµãÆ½ÖÐ¶Ï
  181   2              P5_MODE_IO_PU(GPIOx->Pin);   //×¼Ë«Ïò¿Ú
  182   2              P5INTE |= GPIOx->Pin;        //Ê¹ÄÜP5.PinÖÐ¶Ï
  183   2              }
  184   1         /* ÈôÓÐP6,P7»¹¿ÉÌí¼Ó */
  185   1          return SUCCESS;             //³É¹¦
  186   1      }
  187          
  188          
  189          /***********************************************************************************
  190           * º¯ Êý Ãû: NVIC_PxINT_Init
  191           * Ãè    Êö: PxINTÇ¶Ì×ÏòÁ¿ÖÐ¶Ï¿ØÖÆÆ÷³õÊ¼»¯.
  192           * ²Î    Êý: Priority: ÖÐ¶ÏÓÅÏÈ¼¶, Priority_0,Priority_1,Priority_2,Priority_3.
  193           * ·µ    »Ø: Ö´ÐÐ½á¹û SUCCESS/FAIL.
  194           * °æ    ±¾: V1.0, 2024-11-20
  195           **********************************************************************************/
  196          u8 NVIC_PxINT_Init(u8 GPIO_Px, u8 Priority)
  197          {
  198   1          if(GPIO_Px > GPIO_P7)       return FAIL;
  199   1          if(Priority <= Priority_3)
  200   1          {
  201   2              if(0 == Priority) PINIPH &= ~(0x01<<GPIO_Px), PINIPL &= ~(0x01<<GPIO_Px);
  202   2              if(1 == Priority) PINIPH &= ~(0x01<<GPIO_Px), PINIPL |=  (0x01<<GPIO_Px);
  203   2                      if(2 == Priority) PINIPH |=  (0x01<<GPIO_Px), PINIPL &= ~(0x01<<GPIO_Px);
  204   2                      if(3 == Priority) PINIPH |=  (0x01<<GPIO_Px), PINIPL |=  (0x01<<GPIO_Px);
  205   2          }
  206   1          else  return FAIL; //Px¶Ë¿ÚµÄÖÐ¶ÏÓÅÏÈ¼¶
  207   1      
  208   1      
  209   1      //    switch(GPIO_Px)  //Á½ÖÖ·½Ê½¶¼¿ÉÒÔ
  210   1      //    {
  211   1      //        case GPIO_P0: PO_INT_Priority(Priority); break;
  212   1      //        case GPIO_P1: P1_INT_Priority(Priority); break;
  213   1      //        case GPIO_P2: P2_INT_Priority(Priority); break;
  214   1      //        case GPIO_P3: P3_INT_Priority(Priority); break;
  215   1      //        case GPIO_P4: P4_INT_Priority(Priority); break;
  216   1      //        case GPIO_P5: P5_INT_Priority(Priority); break;
  217   1      //        case GPIO_P6: P6_INT_Priority(Priority); break;
  218   1      //        case GPIO_P7: P7_INT_Priority(Priority); break;
  219   1      //        default: 
  220   1      //            break;
  221   1      //    }
  222   1      //
  223   1              return SUCCESS;
  224   1      }
  225          
  226          
  227          /***********************************************************************************
  228           * º¯ Êý Ãû£ºvoid GPIO_PxINT_Init()
  229           * ¹¦    ÄÜ£ºIO¶Ë¿ÚÖÐ¶Ï£¬³õÊ¼»¯£¬ÉèÖÃÖÐ¶ÏIO£¬ÒÔ¼°ÖÐ¶ÏÄ£Ê½¡¢¶Ë¿ÚÓÅÏÈ¼¶µÈ
  230           * ²Î    Êý£ºÎÞ
  231           * ·µ »Ø Öµ£ºÎÞ
  232           * Ëµ    Ã÷£ºAI8051U»òSTC32GÖ§³ÖËùÓÐÆÕÍ¨I/O¿ÉÖÐ¶Ï£¬ÇÐ¼ÇÐèÒªÊÖ¶¯Çå³ýÖÐ¶Ï±êÖ¾Î»£¨Ïê¼ûÖÐ¶Ï·þÎñº¯Êý£©
  233           **********************************************************************************/
  234          void GPIO_PxINT_Init()
  235          {
  236   1          GPIO_InitTypeDef  GPIO_PxINT_Structure;
  237   1      
  238   1          GPIO_PxINT_Structure.Pin  = GPIO_Pin_0|GPIO_Pin_3;  //Òª³õÊ¼»¯µÄI/O  eg: GPIO_Pin_0|GPIO_Pin_2;
  239   1          GPIO_PxINT_Structure.Mode = PxINT_MODE_Fall;        //³õÊ¼»¯µÄI/O Ä£Ê½ ÏÂ½µÑØ´¥·¢ÖÐ¶Ï
  240   1          GPIO_INT_InitE(GPIO_P0,&GPIO_PxINT_Structure);      //³õÊ¼»¯¹Ü½ÅÖÐ¶ÏÄ£Ê½ÐÐ ²¢ >Ê¹ÄÜ< Æä¹Ü½ÅÖÐ¶Ï£¡£¡£¡
  241   1      //    P0_ENABLE_IOINT(Pinx);                              //  Ê¹ÄÜP0.Pinx¹Ü½Å IOÖÐ¶Ï£¬Ê§ÄÜ£ºP0_DISENABLE_
             -IOINT(Pin)
  242   1          //¸ù¾Ý³õÊ¼»¯µÄÖÐ¶ÏÄ£Ê½Ñ¡ÔñÊÇ·ñÐèÒª¿ªÆô£¬ÄÚ²¿ÉÏÏÂÀ­µç×è
  243   1          P0_PULL_UP_ENABLE(GPIO_Pin_0);                      //Ê¹ÄÜP0.0 ¿ÚÄÚ²¿ÉÏÀ­µç×è£¡£¡£¡
C251 COMPILER V5.60.0,  LQ_XINT                                                            18/11/25  13:07:53  PAGE 5   

  244   1      
  245   1          NVIC_PxINT_Init(GPIO_P0,Priority_0);                //ÖÐ¶ÏÓÅÏÈ¼¶ÅäÖÃ,¶ÔÏóÊÇ¶Ë¿Ú PO_INT_Priority(Prior
             -ity_0)£»
  246   1      }
  247          
  248          
  249          /***********************************************************************************
  250           * º¯ Êý Ãû£ºvoid Test_GPIO_PxINT()
  251           * ¹¦    ÄÜ£ºSTC GPIOÖÐ¶Ï²âÊÔº¯Êý£¬ÖÐ¶Ï·þÎñº¯ÊýÖÐLED0×´Ì¬
  252           * ²Î    Êý£ºÎÞ
  253           * ·µ »Ø Öµ£ºÎÞ
  254           * Ëµ    Ã÷£ºAI8051U»òSTC32GÖ§³ÖËùÓÐÆÕÍ¨I/O¿ÉÖÐ¶Ï£¬ÇÐ¼ÇÐèÒªÊÖ¶¯Çå³ýÖÐ¶Ï±êÖ¾Î»£¨Ïê¼ûÖÐ¶Ï·þÎñº¯Êý£©
  255           **********************************************************************************/
  256          void Test_GPIO_PxINT()
  257          {
  258   1      
  259   1          GPIO_LED_Init();
  260   1          OLED_Init();
  261   1          GPIO_PxINT_Init();          //ÇëÇ°Íù AI8051U_GPIO_ISR.C ÖÐ¶ÔÓ¦µÄÖÐ¶Ï·þÎñº¯ÊýÖÐ±àÐ´ÖÐ¶Ï·þÎñ³ÌÐò
  262   1          Global_IRQ_Enable();
  263   1      
  264   1          OLED_CLS();
  265   1          OLED_P8x16Str(0, 0,"Test P0_0 INT");
  266   1      
  267   1          while(1)
  268   1          {
  269   2              ;
  270   2          }
  271   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      1770     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------          4
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        31     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
