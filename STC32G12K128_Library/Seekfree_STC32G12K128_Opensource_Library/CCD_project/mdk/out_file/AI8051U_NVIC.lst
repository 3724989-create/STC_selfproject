C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE AI8051U_NVIC
OBJECT MODULE PLACED IN .\out_file\AI8051U_NVIC.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\lq_libraries\Driver\Src\AI8051U_NVIC.c LARGE NOALIAS FLOAT64 WARNINGLEV
                    -EL(3) OPTIMIZE(SIZE) BROWSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\
                    -..\libraries\zf_driver;..\user;..\code;..\Hardware;..\lq_libraries\LQ_LIB\Inc;..\lq_libraries\Include;..\lq_libraries\Dr
                    -iver\Inc) DEBUG PRINT(.\out_file\AI8051U_NVIC.lst) OBJECT(.\out_file\AI8051U_NVIC.obj) 

stmt  level    source

    1          /*---------------------------------------------------------------------*/
    2          /* ------------------- Web: www.STCAI.com -----------------------------*/
    3          /*---------------------------------------------------------------------*/
    4          
    5          #include "AI8051U_NVIC.h"
    6          
    7          //========================================================================
    8          // 函数: NVIC_Timer0_Init
    9          // 描述: Timer0嵌套向量中断控制器初始化.
   10          // 参数: State:    中断使能状态, ENABLE/DISABLE.
   11          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
   12          // 返回: 执行结果 SUCCESS/FAIL.
   13          // 版本: V1.0, 2020-09-29
   14          //========================================================================
   15          u8 NVIC_Timer0_Init(u8 State, u8 Priority)
   16          {
   17   1              if (State <= ENABLE)
   18   1                      Timer0_Interrupt(State);
   19   1              else
   20   1                      return FAIL;
   21   1              if (Priority <= Priority_3)
   22   1                      Timer0_Priority(Priority);
   23   1              else
   24   1                      return FAIL;
   25   1              return SUCCESS;
   26   1      }
   27          
   28          //========================================================================
   29          // 函数: NVIC_Timer1_Init
   30          // 描述: Timer1嵌套向量中断控制器初始化.
   31          // 参数: State:    中断使能状态, ENABLE/DISABLE.
   32          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
   33          // 返回: 执行结果 SUCCESS/FAIL.
   34          // 版本: V1.0, 2020-09-29
   35          //========================================================================
   36          u8 NVIC_Timer1_Init(u8 State, u8 Priority)
   37          {
   38   1              if (State <= ENABLE)
   39   1                      Timer1_Interrupt(State);
   40   1              else
   41   1                      return FAIL;
   42   1              if (Priority <= Priority_3)
   43   1                      Timer1_Priority(Priority);
   44   1              else
   45   1                      return FAIL;
   46   1              return SUCCESS;
   47   1      }
   48          
   49          //========================================================================
   50          // 函数: NVIC_Timer2_Init
   51          // 描述: Timer2嵌套向量中断控制器初始化.
   52          // 参数: State:    中断使能状态, ENABLE/DISABLE.
   53          // 参数: Priority: 中断优先级, NULLD.
   54          // 返回: 执行结果 SUCCESS/FAIL.
   55          // 版本: V1.0, 2020-09-29
   56          //========================================================================
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 2   

   57          u8 NVIC_Timer2_Init(u8 State, u8 Priority)
   58          {
   59   1              if (State <= ENABLE)
   60   1                      Timer2_Interrupt(State);
   61   1              else
   62   1                      return FAIL;
   63   1              Priority = NULLD;
   64   1              return SUCCESS;
   65   1      }
   66          
   67          //========================================================================
   68          // 函数: NVIC_Timer3_Init
   69          // 描述: Timer3嵌套向量中断控制器初始化.
   70          // 参数: State:    中断使能状态, ENABLE/DISABLE.
   71          // 参数: Priority: 中断优先级, NULLD.
   72          // 返回: 执行结果 SUCCESS/FAIL.
   73          // 版本: V1.0, 2020-09-29
   74          //========================================================================
   75          u8 NVIC_Timer3_Init(u8 State, u8 Priority)
   76          {
   77   1              if (State <= ENABLE)
   78   1                      Timer3_Interrupt(State);
   79   1              else
   80   1                      return FAIL;
   81   1              Priority = NULLD;
   82   1              return SUCCESS;
   83   1      }
   84          
   85          //========================================================================
   86          // 函数: NVIC_Timer4_Init
   87          // 描述: Timer4嵌套向量中断控制器初始化.
   88          // 参数: State:    中断使能状态, ENABLE/DISABLE.
   89          // 参数: Priority: 中断优先级, NULLD.
   90          // 返回: 执行结果 SUCCESS/FAIL.
   91          // 版本: V1.0, 2020-09-29
   92          //========================================================================
   93          u8 NVIC_Timer4_Init(u8 State, u8 Priority)
   94          {
   95   1              if (State <= ENABLE)
   96   1                      Timer4_Interrupt(State);
   97   1              else
   98   1                      return FAIL;
   99   1              Priority = NULLD;
  100   1              return SUCCESS;
  101   1      }
  102          
  103          //========================================================================
  104          // 函数: NVIC_Timer11_Init
  105          // 描述: Timer11嵌套向量中断控制器初始化.
  106          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  107          // 参数: Priority: 中断优先级, NULLD.
  108          // 返回: 执行结果 SUCCESS/FAIL.
  109          // 版本: V1.0, 2024-12-26
  110          //========================================================================
  111          u8 NVIC_Timer11_Init(u8 State, u8 Priority)
  112          {
  113   1              if (State <= ENABLE)
  114   1              Timer11_Interrupt(State);
  115   1              else
  116   1                      return FAIL;
  117   1              Priority = NULLD;
  118   1              return SUCCESS;
  119   1      }
  120          
  121          
  122          //========================================================================
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 3   

  123          // 函数: NVIC_INT0_Init
  124          // 描述: INT0嵌套向量中断控制器初始化.
  125          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  126          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  127          // 返回: 执行结果 SUCCESS/FAIL.
  128          // 版本: V1.0, 2020-09-29
  129          //========================================================================
  130          u8 NVIC_INT0_Init(u8 State, u8 Priority)
  131          {
  132   1              if (State <= ENABLE)
  133   1                      INT0_Interrupt(State);
  134   1              else
  135   1                      return FAIL;
  136   1              if (Priority <= Priority_3)
  137   1                      INT0_Priority(Priority);
  138   1              else
  139   1                      return FAIL;
  140   1              return SUCCESS;
  141   1      }
  142          
  143          //========================================================================
  144          // 函数: NVIC_INT1_Init
  145          // 描述: INT1嵌套向量中断控制器初始化.
  146          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  147          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  148          // 返回: 执行结果 SUCCESS/FAIL.
  149          // 版本: V1.0, 2020-09-29
  150          //========================================================================
  151          u8 NVIC_INT1_Init(u8 State, u8 Priority)
  152          {
  153   1              if (State <= ENABLE)
  154   1                      INT1_Interrupt(State);
  155   1              else
  156   1                      return FAIL;
  157   1              if (Priority <= Priority_3)
  158   1                      INT1_Priority(Priority);
  159   1              else
  160   1                      return FAIL;
  161   1              return SUCCESS;
  162   1      }
  163          
  164          //========================================================================
  165          // 函数: NVIC_INT2_Init
  166          // 描述: INT2嵌套向量中断控制器初始化.
  167          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  168          // 参数: Priority: 中断优先级, NULLD.
  169          // 返回: 执行结果 SUCCESS/FAIL.
  170          // 版本: V1.0, 2020-09-29
  171          //========================================================================
  172          u8 NVIC_INT2_Init(u8 State, u8 Priority)
  173          {
  174   1              if (State <= ENABLE)
  175   1                      INT2_Interrupt(State);
  176   1              else
  177   1                      return FAIL;
  178   1              Priority = NULLD;
  179   1              return SUCCESS;
  180   1      }
  181          
  182          //========================================================================
  183          // 函数: NVIC_INT3_Init
  184          // 描述: INT3嵌套向量中断控制器初始化.
  185          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  186          // 参数: Priority: 中断优先级, NULLD.
  187          // 返回: 执行结果 SUCCESS/FAIL.
  188          // 版本: V1.0, 2020-09-29
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 4   

  189          //========================================================================
  190          u8 NVIC_INT3_Init(u8 State, u8 Priority)
  191          {
  192   1              if (State <= ENABLE)
  193   1                      INT3_Interrupt(State);
  194   1              else
  195   1                      return FAIL;
  196   1              Priority = NULLD;
  197   1              return SUCCESS;
  198   1      }
  199          
  200          //========================================================================
  201          // 函数: NVIC_INT4_Init
  202          // 描述: INT4嵌套向量中断控制器初始化.
  203          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  204          // 参数: Priority: 中断优先级, NULLD.
  205          // 返回: 执行结果 SUCCESS/FAIL.
  206          // 版本: V1.0, 2020-09-29
  207          //========================================================================
  208          u8 NVIC_INT4_Init(u8 State, u8 Priority)
  209          {
  210   1              if (State <= ENABLE)
  211   1                      INT4_Interrupt(State);
  212   1              else
  213   1                      return FAIL;
  214   1              Priority = NULLD;
  215   1              return SUCCESS;
  216   1      }
  217          
  218          //========================================================================
  219          // 函数: NVIC_ADC_Init
  220          // 描述: ADC嵌套向量中断控制器初始化.
  221          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  222          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  223          // 返回: 执行结果 SUCCESS/FAIL.
  224          // 版本: V1.0, 2020-09-29
  225          //========================================================================
  226          u8 NVIC_ADC_Init(u8 State, u8 Priority)
  227          {
  228   1              if (State <= ENABLE)
  229   1                      ADC_Interrupt(State);
  230   1              else
  231   1                      return FAIL;
  232   1              if (Priority <= Priority_3)
  233   1                      ADC_Priority(Priority);
  234   1              else
  235   1                      return FAIL;
  236   1              return SUCCESS;
  237   1      }
  238          
  239          //========================================================================
  240          // 函数: NVIC_CMP_Init
  241          // 描述: 比较器嵌套向量中断控制器初始化.
  242          // 参数: State:    中断使能状态, RISING_EDGE/FALLING_EDGE/DISABLE.
  243          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  244          // 返回: 执行结果 SUCCESS/FAIL.
  245          // 版本: V1.0, 2020-09-29
  246          //========================================================================
  247          u8 NVIC_CMP_Init(u8 State, u8 Priority)
  248          {
  249   1              if (State & RISING_EDGE)
  250   1                      PIE = 1; // 允许上升沿中断
  251   1              else
  252   1                      PIE = 0; // 禁止上升沿中断
  253   1              if (State & FALLING_EDGE)
  254   1                      NIE = 1; // 允许下降沿中断
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 5   

  255   1              else
  256   1                      NIE = 0; // 禁止上升沿中断
  257   1              if (Priority <= Priority_3)
  258   1                      CMP_Priority(Priority);
  259   1              else
  260   1                      return FAIL;
  261   1              return SUCCESS;
  262   1      }
  263          
  264          //========================================================================
  265          // 函数: NVIC_I2C_Init
  266          // 描述: I2C嵌套向量中断控制器初始化.
  267          // 参数: Mode:     模式, I2C_Mode_Master/I2C_Mode_Slave.
  268          // 参数: State:    中断使能状态, I2C_Mode_Master: ENABLE/DISABLE.
  269          //                              I2C_Mode_Slave: I2C_ESTAI/I2C_ERXI/I2C_ETXI/I2C_ESTOI/DISABLE.
  270          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  271          // 返回: 执行结果 SUCCESS/FAIL.
  272          // 版本: V1.0, 2020-09-29
  273          //========================================================================
  274          u8 NVIC_I2C_Init(u8 Mode, u8 State, u8 Priority)
  275          {
  276   1              if (Mode > 1)
  277   1                      return FAIL;
  278   1              if (Mode == 1) // I2C_Mode_Master
  279   1              {
  280   2                      I2C_Master_Inturrupt(State);
  281   2              }
  282   1              else if (Mode == 0) // I2C_Mode_Slave
  283   1              {
  284   2                      I2CSLCR = (I2CSLCR & ~0x78) | State;
  285   2              }
  286   1              if (Priority <= Priority_3)
  287   1                      CMP_Priority(Priority);
  288   1              else
  289   1                      return FAIL;
  290   1              return SUCCESS;
  291   1      }
  292          
  293          //========================================================================
  294          // 函数: NVIC_UART1_Init
  295          // 描述: UART1嵌套向量中断控制器初始化.
  296          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  297          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  298          // 返回: 执行结果 SUCCESS/FAIL.
  299          // 版本: V1.0, 2020-09-29
  300          //========================================================================
  301          u8 NVIC_UART1_Init(u8 State, u8 Priority)
  302          {
  303   1              if (State <= ENABLE)
  304   1                      UART1_Interrupt(State);
  305   1              else
  306   1                      return FAIL;
  307   1              if (Priority <= Priority_3)
  308   1                      UART1_Priority(Priority);
  309   1              else
  310   1                      return FAIL;
  311   1              return SUCCESS;
  312   1      }
  313          
  314          //========================================================================
  315          // 函数: NVIC_UART2_Init
  316          // 描述: UART2嵌套向量中断控制器初始化.
  317          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  318          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  319          // 返回: 执行结果 SUCCESS/FAIL.
  320          // 版本: V1.0, 2020-09-29
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 6   

  321          //========================================================================
  322          u8 NVIC_UART2_Init(u8 State, u8 Priority)
  323          {
  324   1              if (State <= ENABLE)
  325   1                      UART2_Interrupt(State);
  326   1              else
  327   1                      return FAIL;
  328   1              if (Priority <= Priority_3)
  329   1                      UART2_Priority(Priority);
  330   1              else
  331   1                      return FAIL;
  332   1              return SUCCESS;
  333   1      }
  334          
  335          //========================================================================
  336          // 函数: NVIC_UART3_Init
  337          // 描述: UART3嵌套向量中断控制器初始化.
  338          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  339          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  340          // 返回: 执行结果 SUCCESS/FAIL.
  341          // 版本: V1.0, 2020-09-29
  342          //========================================================================
  343          u8 NVIC_UART3_Init(u8 State, u8 Priority)
  344          {
  345   1              if (State <= ENABLE)
  346   1                      UART3_Interrupt(State);
  347   1              else
  348   1                      return FAIL;
  349   1              if (Priority <= Priority_3)
  350   1                      UART3_Priority(Priority);
  351   1              else
  352   1                      return FAIL;
  353   1              return SUCCESS;
  354   1      }
  355          
  356          //========================================================================
  357          // 函数: NVIC_UART4_Init
  358          // 描述: UART4嵌套向量中断控制器初始化.
  359          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  360          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  361          // 返回: 执行结果 SUCCESS/FAIL.
  362          // 版本: V1.0, 2020-09-29
  363          //========================================================================
  364          u8 NVIC_UART4_Init(u8 State, u8 Priority)
  365          {
  366   1              if (State <= ENABLE)
  367   1                      UART4_Interrupt(State);
  368   1              else
  369   1                      return FAIL;
  370   1              if (Priority <= Priority_3)
  371   1                      UART4_Priority(Priority);
  372   1              else
  373   1                      return FAIL;
  374   1              return SUCCESS;
  375   1      }
  376          
  377          //========================================================================
  378          // 函数: NVIC_SPI_Init
  379          // 描述: SPI嵌套向量中断控制器初始化.
  380          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  381          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  382          // 返回: 执行结果 SUCCESS/FAIL.
  383          // 版本: V1.0, 2020-09-29
  384          //========================================================================
  385          u8 NVIC_SPI_Init(u8 State, u8 Priority)
  386          {
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 7   

  387   1              if (State <= ENABLE)
  388   1                      SPI_Interrupt(State);
  389   1              else
  390   1                      return FAIL;
  391   1              if (Priority <= Priority_3)
  392   1                      SPI_Priority(Priority);
  393   1              else
  394   1                      return FAIL;
  395   1              return SUCCESS;
  396   1      }
  397          
  398          //========================================================================
  399          // 函数: NVIC_RTC_Init
  400          // 描述: SPI嵌套向量中断控制器初始化.
  401          // 参数: State:    中断使能状态, 中断使能, 0x80:闹钟中断, 0x40:日中断, 0x20:小时中断, 0x10:分钟中断, 0x08
             -:秒中断, 0x04:1/2秒中断, 0x02:1/8秒中断, 0x01:1/32秒中断 /DISABLE.
  402          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  403          // 返回: 执行结果 SUCCESS/FAIL.
  404          // 版本: V1.0, 2020-09-29
  405          //========================================================================
  406          u8 NVIC_RTC_Init(u8 State, u8 Priority)
  407          {
  408   1              if (Priority <= Priority_3)
  409   1                      RTC_Priority(Priority);
  410   1              else
  411   1                      return FAIL;
  412   1              RTC_Interrupt(State);
  413   1              return SUCCESS;
  414   1      }
  415          
  416          //========================================================================
  417          // 函数: NVIC_PWM_Init
  418          // 描述: PWM嵌套向量中断控制器初始化.
  419          // 参数: Channel:  通道, PWMA/PWMB.
  420          // 参数: State:    中断使能状态, PWM_BIE/PWM_TIE/PWM_COMIE/PWM_CC8IE~PWM_CC1IE/PWM_UIE/DISABLE.
  421          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  422          // 返回: 执行结果 SUCCESS/FAIL.
  423          // 版本: V1.0, 2020-09-29
  424          //========================================================================
  425          #ifndef PWMA
  426          #define PWMA 9
  427          #endif
  428          #ifndef PWMB
  429          #define PWMB 10
  430          #endif
  431          u8 NVIC_PWM_Init(u8 Channel, u8 State, u8 Priority)
  432          {
  433   1              if (Channel > PWMB)
  434   1                      return FAIL;
  435   1              if (Priority > Priority_3)
  436   1                      return FAIL;
  437   1              switch (Channel)
  438   1              {
  439   2              case PWMA:
  440   2                      PWMA_IER = State;
  441   2                      PWMA_Priority(Priority);
  442   2                      break;
  443   2      
  444   2              case PWMB:
  445   2                      PWMB_IER = State;
  446   2                      PWMB_Priority(Priority);
  447   2                      break;
  448   2      
  449   2              default:
  450   2                      PWMB_IER = State;
  451   2                      Priority = NULLD;
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 8   

  452   2                      break;
  453   2              }
  454   1              return SUCCESS;
  455   1      }
  456          
  457          //========================================================================
  458          // 函数: NVIC_DMA_ADC_Init
  459          // 描述: DMA ADC嵌套向量中断控制器初始化.
  460          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  461          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  462          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  463          // 返回: 执行结果 SUCCESS/FAIL.
  464          // 版本: V1.0, 2021-05-21
  465          //========================================================================
  466          u8 NVIC_DMA_ADC_Init(u8 State, u8 Priority, u8 Bus_Priority)
  467          {
  468   1              DMA_ADC_CFG &= ~0x0f;
  469   1              if (Priority <= Priority_3)
  470   1                      DMA_ADC_CFG |= Priority << 2;
  471   1              if (Bus_Priority <= Priority_3)
  472   1                      DMA_ADC_CFG |= Bus_Priority; // 数据总线访问优先级
  473   1              if (State == ENABLE)
  474   1                      DMA_ADC_CFG |= 0x80; // bit7 1:Enable Interrupt
  475   1              else
  476   1                      DMA_ADC_CFG &= ~0x80; // bit7 0:Disable Interrupt
  477   1              return SUCCESS;
  478   1      }
  479          
  480          //========================================================================
  481          // 函数: NVIC_DMA_M2M_Init
  482          // 描述: DMA M2M嵌套向量中断控制器初始化.
  483          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  484          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  485          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  486          // 返回: 执行结果 SUCCESS/FAIL.
  487          // 版本: V1.0, 2021-05-21
  488          //========================================================================
  489          u8 NVIC_DMA_M2M_Init(u8 State, u8 Priority, u8 Bus_Priority)
  490          {
  491   1              DMA_M2M_CFG &= ~0x0f;
  492   1              if (Priority <= Priority_3)
  493   1                      DMA_M2M_CFG |= Priority << 2;
  494   1              if (Bus_Priority <= Priority_3)
  495   1                      DMA_M2M_CFG |= Bus_Priority; // 数据总线访问优先级
  496   1              if (State == ENABLE)
  497   1                      DMA_M2M_CFG |= 0x80; // bit7 1:Enable Interrupt
  498   1              else
  499   1                      DMA_M2M_CFG &= ~0x80; // bit7 0:Disable Interrupt
  500   1              return SUCCESS;
  501   1      }
  502          
  503          //========================================================================
  504          // 函数: NVIC_DMA_SPI_Init
  505          // 描述: DMA SPI嵌套向量中断控制器初始化.
  506          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  507          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  508          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  509          // 返回: 执行结果 SUCCESS/FAIL.
  510          // 版本: V1.0, 2021-05-27
  511          //========================================================================
  512          u8 NVIC_DMA_SPI_Init(u8 State, u8 Priority, u8 Bus_Priority)
  513          {
  514   1              DMA_SPI_CFG &= ~0x0f;
  515   1              if (Priority <= Priority_3)
  516   1                      DMA_SPI_CFG |= Priority << 2;
  517   1              if (Bus_Priority <= Priority_3)
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 9   

  518   1                      DMA_SPI_CFG |= Bus_Priority; // 数据总线访问优先级
  519   1              if (State == ENABLE)
  520   1                      DMA_SPI_CFG |= 0x80; // bit7 1:Enable Interrupt
  521   1              else
  522   1                      DMA_SPI_CFG &= ~0x80; // bit7 0:Disable Interrupt
  523   1              return SUCCESS;
  524   1      }
  525          
  526          //========================================================================
  527          // 函数: NVIC_DMA_UART1_Tx_Init
  528          // 描述: DMA UART1 Tx嵌套向量中断控制器初始化.
  529          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  530          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  531          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  532          // 返回: 执行结果 SUCCESS/FAIL.
  533          // 版本: V1.0, 2021-05-21
  534          //========================================================================
  535          u8 NVIC_DMA_UART1_Tx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  536          {
  537   1              DMA_UR1T_CFG &= ~0x0f;
  538   1              if (Priority <= Priority_3)
  539   1                      DMA_UR1T_CFG |= Priority << 2;
  540   1              if (Bus_Priority <= Priority_3)
  541   1                      DMA_UR1T_CFG |= Bus_Priority; // 数据总线访问优先级
  542   1              if (State == ENABLE)
  543   1                      DMA_UR1T_CFG |= 0x80; // bit7 1:Enable Interrupt
  544   1              else
  545   1                      DMA_UR1T_CFG &= ~0x80; // bit7 0:Disable Interrupt
  546   1              return SUCCESS;
  547   1      }
  548          
  549          //========================================================================
  550          // 函数: NVIC_DMA_UART1_Rx_Init
  551          // 描述: DMA UART1 Rx嵌套向量中断控制器初始化.
  552          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  553          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  554          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  555          // 返回: 执行结果 SUCCESS/FAIL.
  556          // 版本: V1.0, 2021-05-21
  557          //========================================================================
  558          u8 NVIC_DMA_UART1_Rx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  559          {
  560   1              DMA_UR1R_CFG &= ~0x0f;
  561   1              if (Priority <= Priority_3)
  562   1                      DMA_UR1R_CFG |= Priority << 2;
  563   1              if (Bus_Priority <= Priority_3)
  564   1                      DMA_UR1R_CFG |= Bus_Priority; // 数据总线访问优先级
  565   1              if (State == ENABLE)
  566   1                      DMA_UR1R_CFG |= 0x80; // bit7 1:Enable Interrupt
  567   1              else
  568   1                      DMA_UR1R_CFG &= ~0x80; // bit7 0:Disable Interrupt
  569   1              return SUCCESS;
  570   1      }
  571          
  572          //========================================================================
  573          // 函数: NVIC_DMA_UART2_Tx_Init
  574          // 描述: DMA UART2 Tx嵌套向量中断控制器初始化.
  575          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  576          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  577          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  578          // 返回: 执行结果 SUCCESS/FAIL.
  579          // 版本: V1.0, 2021-05-21
  580          //========================================================================
  581          u8 NVIC_DMA_UART2_Tx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  582          {
  583   1              DMA_UR2T_CFG &= ~0x0f;
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 10  

  584   1              if (Priority <= Priority_3)
  585   1                      DMA_UR2T_CFG |= Priority << 2;
  586   1              if (Bus_Priority <= Priority_3)
  587   1                      DMA_UR2T_CFG |= Bus_Priority; // 数据总线访问优先级
  588   1              if (State == ENABLE)
  589   1                      DMA_UR2T_CFG |= 0x80; // bit7 1:Enable Interrupt
  590   1              else
  591   1                      DMA_UR2T_CFG &= ~0x80; // bit7 0:Disable Interrupt
  592   1              return SUCCESS;
  593   1      }
  594          
  595          //========================================================================
  596          // 函数: NVIC_DMA_UART2_Rx_Init
  597          // 描述: DMA UART2 Rx嵌套向量中断控制器初始化.
  598          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  599          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  600          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  601          // 返回: 执行结果 SUCCESS/FAIL.
  602          // 版本: V1.0, 2021-05-21
  603          //========================================================================
  604          u8 NVIC_DMA_UART2_Rx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  605          {
  606   1              DMA_UR2R_CFG &= ~0x0f;
  607   1              if (Priority <= Priority_3)
  608   1                      DMA_UR2R_CFG |= Priority << 2;
  609   1              if (Bus_Priority <= Priority_3)
  610   1                      DMA_UR2R_CFG |= Bus_Priority; // 数据总线访问优先级
  611   1              if (State == ENABLE)
  612   1                      DMA_UR2R_CFG |= 0x80; // bit7 1:Enable Interrupt
  613   1              else
  614   1                      DMA_UR2R_CFG &= ~0x80; // bit7 0:Disable Interrupt
  615   1              return SUCCESS;
  616   1      }
  617          
  618          //========================================================================
  619          // 函数: NVIC_DMA_UART3_Tx_Init
  620          // 描述: DMA UART3 Tx嵌套向量中断控制器初始化.
  621          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  622          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  623          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  624          // 返回: 执行结果 SUCCESS/FAIL.
  625          // 版本: V1.0, 2021-05-21
  626          //========================================================================
  627          u8 NVIC_DMA_UART3_Tx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  628          {
  629   1              DMA_UR3T_CFG &= ~0x0f;
  630   1              if (Priority <= Priority_3)
  631   1                      DMA_UR3T_CFG |= Priority << 2;
  632   1              if (Bus_Priority <= Priority_3)
  633   1                      DMA_UR3T_CFG |= Bus_Priority; // 数据总线访问优先级
  634   1              if (State == ENABLE)
  635   1                      DMA_UR3T_CFG |= 0x80; // bit7 1:Enable Interrupt
  636   1              else
  637   1                      DMA_UR3T_CFG &= ~0x80; // bit7 0:Disable Interrupt
  638   1              return SUCCESS;
  639   1      }
  640          
  641          //========================================================================
  642          // 函数: NVIC_DMA_UART3_Rx_Init
  643          // 描述: DMA UART3 Rx嵌套向量中断控制器初始化.
  644          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  645          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  646          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  647          // 返回: 执行结果 SUCCESS/FAIL.
  648          // 版本: V1.0, 2021-05-21
  649          //========================================================================
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 11  

  650          u8 NVIC_DMA_UART3_Rx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  651          {
  652   1              DMA_UR3R_CFG &= ~0x0f;
  653   1              if (Priority <= Priority_3)
  654   1                      DMA_UR3R_CFG |= Priority << 2;
  655   1              if (Bus_Priority <= Priority_3)
  656   1                      DMA_UR3R_CFG |= Bus_Priority; // 数据总线访问优先级
  657   1              if (State == ENABLE)
  658   1                      DMA_UR3R_CFG |= 0x80; // bit7 1:Enable Interrupt
  659   1              else
  660   1                      DMA_UR3R_CFG &= ~0x80; // bit7 0:Disable Interrupt
  661   1              return SUCCESS;
  662   1      }
  663          
  664          //========================================================================
  665          // 函数: NVIC_DMA_UART4_Tx_Init
  666          // 描述: DMA UART4 Tx嵌套向量中断控制器初始化.
  667          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  668          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  669          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  670          // 返回: 执行结果 SUCCESS/FAIL.
  671          // 版本: V1.0, 2021-05-21
  672          //========================================================================
  673          u8 NVIC_DMA_UART4_Tx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  674          {
  675   1              DMA_UR4T_CFG &= ~0x0f;
  676   1              if (Priority <= Priority_3)
  677   1                      DMA_UR4T_CFG |= Priority << 2;
  678   1              if (Bus_Priority <= Priority_3)
  679   1                      DMA_UR4T_CFG |= Bus_Priority; // 数据总线访问优先级
  680   1              if (State == ENABLE)
  681   1                      DMA_UR4T_CFG |= 0x80; // bit7 1:Enable Interrupt
  682   1              else
  683   1                      DMA_UR4T_CFG &= ~0x80; // bit7 0:Disable Interrupt
  684   1              return SUCCESS;
  685   1      }
  686          
  687          //========================================================================
  688          // 函数: NVIC_DMA_UART4_Rx_Init
  689          // 描述: DMA UART4 Rx嵌套向量中断控制器初始化.
  690          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  691          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  692          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  693          // 返回: 执行结果 SUCCESS/FAIL.
  694          // 版本: V1.0, 2021-05-21
  695          //========================================================================
  696          u8 NVIC_DMA_UART4_Rx_Init(u8 State, u8 Priority, u8 Bus_Priority)
  697          {
  698   1              DMA_UR4R_CFG &= ~0x0f;
  699   1              if (Priority <= Priority_3)
  700   1                      DMA_UR4R_CFG |= Priority << 2;
  701   1              if (Bus_Priority <= Priority_3)
  702   1                      DMA_UR4R_CFG |= Bus_Priority; // 数据总线访问优先级
  703   1              if (State == ENABLE)
  704   1                      DMA_UR4R_CFG |= 0x80; // bit7 1:Enable Interrupt
  705   1              else
  706   1                      DMA_UR4R_CFG &= ~0x80; // bit7 0:Disable Interrupt
  707   1              return SUCCESS;
  708   1      }
  709          
  710          //========================================================================
  711          // 函数: NVIC_DMA_LCM_Init
  712          // 描述: DMA LCM嵌套向量中断控制器初始化.
  713          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  714          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  715          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 12  

  716          // 返回: 执行结果 SUCCESS/FAIL.
  717          // 版本: V1.0, 2021-05-21
  718          //========================================================================
  719          //u8 NVIC_DMA_LCM_Init(u8 State, u8 Priority, u8 Bus_Priority)
  720          //{
  721          //      DMA_LCM_CFG &= ~0x0f;
  722          //      if (Priority <= Priority_3)
  723          //              DMA_LCM_CFG |= Priority << 2;
  724          //      if (Bus_Priority <= Priority_3)
  725          //              DMA_LCM_CFG |= Bus_Priority; // 数据总线访问优先级
  726          //      if (State == ENABLE)
  727          //              DMA_LCM_CFG |= 0x80; // bit7 1:Enable Interrupt
  728          //      else
  729          //              DMA_LCM_CFG &= ~0x80; // bit7 0:Disable Interrupt
  730          //      return SUCCESS;
  731          //}
  732          
  733          //========================================================================
  734          // 函数: NVIC_LCM_Init
  735          // 描述: LCM嵌套向量中断控制器初始化.
  736          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  737          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  738          // 返回: 执行结果 SUCCESS/FAIL.
  739          // 版本: V1.0, 2021-05-21
  740          //========================================================================
  741          //u8 NVIC_LCM_Init(u8 State, u8 Priority)
  742          //{
  743          //      LCMIFCFG &= ~0x30;
  744          //      if (Priority <= Priority_3)
  745          //              LCMIFCFG |= Priority << 4;
  746          //      if (State == ENABLE)
  747          //              LCMIFCFG |= 0x80; // bit7 1:Enable Interrupt
  748          //      else
  749          //              LCMIFCFG &= ~0x80; // bit7 0:Disable Interrupt
  750          //      return SUCCESS;
  751          //}
  752          
  753          //========================================================================
  754          // 函数: NVIC_DMA_I2CT_Init
  755          // 描述: DMA I2C Tx嵌套向量中断控制器初始化.
  756          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  757          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  758          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  759          // 返回: 执行结果 SUCCESS/FAIL.
  760          // 版本: V1.0, 2022-03-25
  761          //========================================================================
  762          u8 NVIC_DMA_I2CT_Init(u8 State, u8 Priority, u8 Bus_Priority)
  763          {
  764   1              DMA_I2CT_CFG &= ~0x0f;
  765   1              if (Priority <= Priority_3)
  766   1                      DMA_I2CT_CFG |= Priority << 2;
  767   1              if (Bus_Priority <= Priority_3)
  768   1                      DMA_I2CT_CFG |= Bus_Priority; // 数据总线访问优先级
  769   1              if (State == ENABLE)
  770   1                      DMA_I2CT_CFG |= 0x80; // bit7 1:Enable Interrupt
  771   1              else
  772   1                      DMA_I2CT_CFG &= ~0x80; // bit7 0:Disable Interrupt
  773   1              return SUCCESS;
  774   1      }
  775          
  776          //========================================================================
  777          // 函数: NVIC_DMA_I2CR_Init
  778          // 描述: DMA I2C Rx嵌套向量中断控制器初始化.
  779          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  780          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  781          // 参数: Bus_Priority: 数据总线访问优先级, Priority_0,Priority_1,Priority_2,Priority_3.
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 13  

  782          // 返回: 执行结果 SUCCESS/FAIL.
  783          // 版本: V1.0, 2022-03-25
  784          //========================================================================
  785          u8 NVIC_DMA_I2CR_Init(u8 State, u8 Priority, u8 Bus_Priority)
  786          {
  787   1              DMA_I2CR_CFG &= ~0x0f;
  788   1              if (Priority <= Priority_3)
  789   1                      DMA_I2CR_CFG |= Priority << 2;
  790   1              if (Bus_Priority <= Priority_3)
  791   1                      DMA_I2CR_CFG |= Bus_Priority; // 数据总线访问优先级
  792   1              if (State == ENABLE)
  793   1                      DMA_I2CR_CFG |= 0x80; // bit7 1:Enable Interrupt
  794   1              else
  795   1                      DMA_I2CR_CFG &= ~0x80; // bit7 0:Disable Interrupt
  796   1              return SUCCESS;
  797   1      }
  798          
  799          //========================================================================
  800          // 函数: NVIC_CAN_Init
  801          // 描述: CAN嵌套向量中断控制器初始化.
  802          // 参数: Channel:  通道, CAN1/CAN2.
  803          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  804          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  805          // 返回: 执行结果 SUCCESS/FAIL.
  806          // 版本: V1.0, 2023-03-27
  807          //========================================================================
  808          //#ifndef CAN1
  809          //#define CAN1 0
  810          //#endif
  811          //#ifndef CAN2
  812          //#define CAN2 1
  813          //#endif
  814          //u8 NVIC_CAN_Init(u8 Channel, u8 State, u8 Priority)
  815          //{
  816          //      if (Channel > CAN2)
  817          //              return FAIL;
  818          //      if (Priority > Priority_3)
  819          //              return FAIL;
  820          //      switch (Channel)
  821          //      {
  822          //      case CAN1:
  823          //              if (State == ENABLE)
  824          //                      CANIE = 1; // bit7 1:Enable Interrupt
  825          //              else
  826          //                      CANIE = 0; // bit7 0:Disable Interrupt
  827          //              CAN1_Priority(Priority);
  828          //              break;
  829          
  830          //      case CAN2:
  831          //              if (State == ENABLE)
  832          //                      CAN2IE = 1; // bit7 1:Enable Interrupt
  833          //              else
  834          //                      CAN2IE = 0; // bit7 0:Disable Interrupt
  835          //              CAN2_Priority(Priority);
  836          //              break;
  837          
  838          //      default:
  839          //              return FAIL;
  840          //              break;
  841          //      }
  842          //      return SUCCESS;
  843          //}
  844          
  845          //========================================================================
  846          // 函数: NVIC_LIN_Init
  847          // 描述: LIN嵌套向量中断控制器初始化.
C251 COMPILER V5.60.0,  AI8051U_NVIC                                                       18/11/25  13:07:44  PAGE 14  

  848          // 参数: State:    中断使能状态, ENABLE/DISABLE.
  849          // 参数: Priority: 中断优先级, Priority_0,Priority_1,Priority_2,Priority_3.
  850          // 返回: 执行结果 SUCCESS/FAIL.
  851          // 版本: V1.0, 2020-09-29
  852          //========================================================================
  853          //u8 NVIC_LIN_Init(u8 State, u8 Priority)
  854          //{
  855          //      if (State <= ENABLE)
  856          //              LIN_Interrupt(State);
  857          //      else
  858          //              return FAIL;
  859          //      if (Priority <= Priority_3)
  860          //              LIN_Priority(Priority);
  861          //      else
  862          //              return FAIL;
  863          //      return SUCCESS;
  864          //}
*** WARNING C183 IN LINE 63 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 81 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 99 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 117 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 178 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 196 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 214 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated
*** WARNING C183 IN LINE 451 OF ..\lq_libraries\Driver\Src\AI8051U_NVIC.c: dead assignment eliminated


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      2366     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  8 WARNING(S),  0 ERROR(S)
