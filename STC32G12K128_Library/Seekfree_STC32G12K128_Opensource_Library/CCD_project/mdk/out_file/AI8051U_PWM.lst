C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE AI8051U_PWM
OBJECT MODULE PLACED IN .\out_file\AI8051U_PWM.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\lq_libraries\Driver\Src\AI8051U_PWM.c LARGE NOALIAS FLOAT64 WARNINGLEVE
                    -L(3) OPTIMIZE(SIZE) BROWSE INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\.
                    -.\libraries\zf_driver;..\user;..\code;..\Hardware;..\lq_libraries\LQ_LIB\Inc;..\lq_libraries\Include;..\lq_libraries\Dri
                    -ver\Inc) DEBUG PRINT(.\out_file\AI8051U_PWM.lst) OBJECT(.\out_file\AI8051U_PWM.obj) 

stmt  level    source

    1          /*---------------------------------------------------------------------*/
    2          /* ------------------- Web: www.STCAI.com -----------------------------*/
    3          /*---------------------------------------------------------------------*/
    4          
    5          #include "AI8051U_PWM.h"
    6          
    7          //========================================================================
    8          // º¯Êý: PWM_Configuration
    9          // ÃèÊö: PWM³õÊ¼»¯³ÌÐò.
   10          // ²ÎÊý: PWMx: ½á¹¹²ÎÊý,Çë²Î¿¼PWM.hÀïµÄ¶¨Òå.
   11          // ·µ»Ø: ³É¹¦·µ»Ø SUCCESS, ´íÎó·µ»Ø FAIL.
   12          // °æ±¾: V1.0, 2012-10-22
   13          //========================================================================
   14          u8 PWM_Configuration(u8 PWM, PWMx_InitDefine *PWMx)
   15          {
   16   1              if (PWM == PWM1)
   17   1              {
   18   2                      PWMA_CC1E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   19   2                      PWMA_CC1NE_Disable();                     // ¹Ø±Õ±È½ÏÊä³ö
   20   2                      PWMA_CC1S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
   21   2                      PWMA_OC1ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
   22   2      
   23   2                      if (PWMx->PWM_EnoSelect & ENO1P)
   24   2                      {
   25   3                              PWMA_CC1E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
   26   3                              PWMA_ENO |= ENO1P;
   27   3                      }
   28   2                      else
   29   2                      {
   30   3                              PWMA_CC1E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   31   3                              PWMA_ENO &= ~ENO1P;
   32   3                      }
   33   2                      if (PWMx->PWM_EnoSelect & ENO1N)
   34   2                      {
   35   3                              PWMA_CC1NE_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
   36   3                              PWMA_ENO |= ENO1N;
   37   3                      }
   38   2                      else
   39   2                      {
   40   3                              PWMA_CC1NE_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   41   3                              PWMA_ENO &= ~ENO1N;
   42   3                      }
   43   2      
   44   2                      PWMA_Duty1(PWMx->PWM_Duty);
   45   2                      return SUCCESS;
   46   2              }
   47   1      
   48   1              if (PWM == PWM2)
   49   1              {
   50   2                      PWMA_CC2E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   51   2                      PWMA_CC2NE_Disable();                     // ¹Ø±Õ±È½ÏÊä³ö
   52   2                      PWMA_CC2S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
   53   2                      PWMA_OC2ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
   54   2      
   55   2                      if (PWMx->PWM_EnoSelect & ENO2P)
   56   2                      {
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 2   

   57   3                              PWMA_CC2E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
   58   3                              PWMA_ENO |= ENO2P;
   59   3                      }
   60   2                      else
   61   2                      {
   62   3                              PWMA_CC2E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   63   3                              PWMA_ENO &= ~ENO2P;
   64   3                      }
   65   2                      if (PWMx->PWM_EnoSelect & ENO2N)
   66   2                      {
   67   3                              PWMA_CC2NE_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
   68   3                              PWMA_ENO |= ENO2N;
   69   3                      }
   70   2                      else
   71   2                      {
   72   3                              PWMA_CC2NE_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   73   3                              PWMA_ENO &= ~ENO2N;
   74   3                      }
   75   2      
   76   2                      PWMA_Duty2(PWMx->PWM_Duty);
   77   2                      return SUCCESS;
   78   2              }
   79   1      
   80   1              if (PWM == PWM3)
   81   1              {
   82   2                      PWMA_CC3E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   83   2                      PWMA_CC3NE_Disable();                     // ¹Ø±Õ±È½ÏÊä³ö
   84   2                      PWMA_CC3S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
   85   2                      PWMA_OC3ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
   86   2      
   87   2                      if (PWMx->PWM_EnoSelect & ENO3P)
   88   2                      {
   89   3                              PWMA_CC3E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
   90   3                              PWMA_ENO |= ENO3P;
   91   3                      }
   92   2                      else
   93   2                      {
   94   3                              PWMA_CC3E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
   95   3                              PWMA_ENO &= ~ENO3P;
   96   3                      }
   97   2                      if (PWMx->PWM_EnoSelect & ENO3N)
   98   2                      {
   99   3                              PWMA_CC3NE_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  100   3                              PWMA_ENO |= ENO3N;
  101   3                      }
  102   2                      else
  103   2                      {
  104   3                              PWMA_CC3NE_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  105   3                              PWMA_ENO &= ~ENO3N;
  106   3                      }
  107   2      
  108   2                      PWMA_Duty3(PWMx->PWM_Duty);
  109   2                      return SUCCESS;
  110   2              }
  111   1      
  112   1              if (PWM == PWM4)
  113   1              {
  114   2                      PWMA_CC4E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  115   2                      PWMA_CC4NE_Disable();                     // ¹Ø±Õ±È½ÏÊä³ö
  116   2                      PWMA_CC4S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
  117   2                      PWMA_OC4ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
  118   2      
  119   2                      if (PWMx->PWM_EnoSelect & ENO4P)
  120   2                      {
  121   3                              PWMA_CC4E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  122   3                              PWMA_ENO |= ENO4P;
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 3   

  123   3                      }
  124   2                      else
  125   2                      {
  126   3                              PWMA_CC4E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  127   3                              PWMA_ENO &= ~ENO4P;
  128   3                      }
  129   2                      if (PWMx->PWM_EnoSelect & ENO4N)
  130   2                      {
  131   3                              PWMA_CC4NE_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  132   3                              PWMA_ENO |= ENO4N;
  133   3                      }
  134   2                      else
  135   2                      {
  136   3                              PWMA_CC4NE_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  137   3                              PWMA_ENO &= ~ENO4N;
  138   3                      }
  139   2      
  140   2                      PWMA_Duty4(PWMx->PWM_Duty);
  141   2                      return SUCCESS;
  142   2              }
  143   1      
  144   1              if (PWM == PWMA)
  145   1              {
  146   2                      //              PWMA_OC1_ReloadEnable(PWMx->PWM_Reload);        //Êä³ö±È½ÏµÄÔ¤×°ÔØÊ¹ÄÜ
  147   2                      //              PWMA_OC1_FastEnable(PWMx->PWM_Fast);            //Êä³ö±È½Ï¿ìËÙ¹¦ÄÜÊ¹ÄÜ
  148   2                      //              PWMA_CCPCAPreloaded(PWMx->PWM_PreLoad);     //²¶»ñ/±È½ÏÔ¤×°ÔØ¿ØÖÆÎ»(¸ÃÎ»Ö»¶Ô¾ßÓÐ»¥²¹Êä³öµÄÍ¨µÀÆð×÷Ó
             -Ã)
  149   2                      //              PWMA_BrakeEnable(PWMx->PWM_BrakeEnable);        //¿ªÆô/½ûÖ¹É²³µÊäÈë
  150   2      
  151   2                      PWMA_DeadTime(PWMx->PWM_DeadTime);                               // ËÀÇø·¢ÉúÆ÷ÉèÖÃ
  152   2                      PWMA_AutoReload(PWMx->PWM_Period);                               // ÖÜÆÚÉèÖÃ
  153   2                      PWMA_BrakeOutputEnable(PWMx->PWM_MainOutEnable); // Ö÷Êä³öÊ¹ÄÜ
  154   2                      PWMA_CEN_Enable(PWMx->PWM_CEN_Enable);                   // Ê¹ÄÜ¼ÆÊýÆ÷
  155   2                      return SUCCESS;
  156   2              }
  157   1      
  158   1              if (PWM == PWM5)
  159   1              {
  160   2                      PWMB_CC5E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  161   2                      PWMB_CC5S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
  162   2                      PWMB_OC5ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
  163   2      
  164   2                      if (PWMx->PWM_EnoSelect & ENO5P)
  165   2                      {
  166   3                              PWMB_CC5E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  167   3                              PWMB_ENO |= ENO5P;
  168   3                      }
  169   2                      else
  170   2                      {
  171   3                              PWMB_CC5E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  172   3                              PWMB_ENO &= ~ENO5P;
  173   3                      }
  174   2      
  175   2                      PWMB_Duty5(PWMx->PWM_Duty);
  176   2                      return SUCCESS;
  177   2              }
  178   1      
  179   1              if (PWM == PWM6)
  180   1              {
  181   2                      PWMB_CC6E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  182   2                      PWMB_CC6S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
  183   2                      PWMB_OC6ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
  184   2      
  185   2                      if (PWMx->PWM_EnoSelect & ENO6P)
  186   2                      {
  187   3                              PWMB_CC6E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 4   

  188   3                              PWMB_ENO |= ENO6P;
  189   3                      }
  190   2                      else
  191   2                      {
  192   3                              PWMB_CC6E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  193   3                              PWMB_ENO &= ~ENO6P;
  194   3                      }
  195   2      
  196   2                      PWMB_Duty6(PWMx->PWM_Duty);
  197   2                      return SUCCESS;
  198   2              }
  199   1      
  200   1              if (PWM == PWM7)
  201   1              {
  202   2                      PWMB_CC7E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  203   2                      PWMB_CC7S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
  204   2                      PWMB_OC7ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
  205   2      
  206   2                      if (PWMx->PWM_EnoSelect & ENO7P)
  207   2                      {
  208   3                              PWMB_CC7E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  209   3                              PWMB_ENO |= ENO7P;
  210   3                      }
  211   2                      else
  212   2                      {
  213   3                              PWMB_CC7E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  214   3                              PWMB_ENO &= ~ENO7P;
  215   3                      }
  216   2      
  217   2                      PWMB_Duty7(PWMx->PWM_Duty);
  218   2                      return SUCCESS;
  219   2              }
  220   1      
  221   1              if (PWM == PWM8)
  222   1              {
  223   2                      PWMB_CC8E_Disable();                      // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  224   2                      PWMB_CC8S_Direction(CCAS_OUTPUT); // CCnS½öÔÚÍ¨µÀ¹Ø±ÕÊ±²ÅÊÇ¿ÉÐ´µÄ
  225   2                      PWMB_OC8ModeSet(PWMx->PWM_Mode);  // ÉèÖÃÊä³ö±È½ÏÄ£Ê½
  226   2      
  227   2                      if (PWMx->PWM_EnoSelect & ENO8P)
  228   2                      {
  229   3                              PWMB_CC8E_Enable(); // ¿ªÆôÊäÈë²¶»ñ/±È½ÏÊä³ö
  230   3                              PWMB_ENO |= ENO8P;
  231   3                      }
  232   2                      else
  233   2                      {
  234   3                              PWMB_CC8E_Disable(); // ¹Ø±ÕÊäÈë²¶»ñ/±È½ÏÊä³ö
  235   3                              PWMB_ENO &= ~ENO8P;
  236   3                      }
  237   2      
  238   2                      PWMB_Duty8(PWMx->PWM_Duty);
  239   2                      return SUCCESS;
  240   2              }
  241   1      
  242   1              if (PWM == PWMB)
  243   1              {
  244   2                      //              PWMB_OC5_ReloadEnable(PWMx->PWM_Reload);        //Êä³ö±È½ÏµÄÔ¤×°ÔØÊ¹ÄÜ
  245   2                      //              PWMB_OC5_FastEnable(PWMx->PWM_Fast);            //Êä³ö±È½Ï¿ìËÙ¹¦ÄÜÊ¹ÄÜ
  246   2                      //              PWMB_CCPCBPreloaded(PWMx->PWM_PreLoad);     //²¶»ñ/±È½ÏÔ¤×°ÔØ¿ØÖÆÎ»(¸ÃÎ»Ö»¶Ô¾ßÓÐ»¥²¹Êä³öµÄÍ¨µÀÆð×÷Ó
             -Ã)
  247   2                      //              PWMB_BrakeEnable(PWMx->PWM_BrakeEnable);        //¿ªÆô/½ûÖ¹É²³µÊäÈë
  248   2      
  249   2                      PWMB_DeadTime(PWMx->PWM_DeadTime);                               // ËÀÇø·¢ÉúÆ÷ÉèÖÃ
  250   2                      PWMB_AutoReload(PWMx->PWM_Period);                               // ÖÜÆÚÉèÖÃ
  251   2                      PWMB_BrakeOutputEnable(PWMx->PWM_MainOutEnable); // Ö÷Êä³öÊ¹ÄÜ
  252   2                      PWMB_CEN_Enable(PWMx->PWM_CEN_Enable);                   // Ê¹ÄÜ¼ÆÊýÆ÷
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 5   

  253   2                      return SUCCESS;
  254   2              }
  255   1      
  256   1              return FAIL; // ´íÎó
  257   1      }
  258          
  259          //========================================================================
  260          // º¯Êý: UpdatePwm
  261          // ÃèÊö: PWMÕ¼¿Õ±È¸üÐÂ³ÌÐò.
  262          // ²ÎÊý: PWM: PWMÍ¨µÀ/×éºÅ, PWMx½á¹¹²ÎÊý,Çë²Î¿¼PWM.hÀïµÄ¶¨Òå.
  263          // ·µ»Ø: none.
  264          // °æ±¾: V1.0, 2012-10-22
  265          //========================================================================
  266          void UpdatePwm(u8 PWM, PWMx_Duty *PWMx)
  267          {
  268   1              switch (PWM)
  269   1              {
  270   2              case PWM1:
  271   2                      PWMA_Duty1(PWMx->PWM1_Duty);
  272   2                      break;
  273   2      
  274   2              case PWM2:
  275   2                      PWMA_Duty2(PWMx->PWM2_Duty);
  276   2                      break;
  277   2      
  278   2              case PWM3:
  279   2                      PWMA_Duty3(PWMx->PWM3_Duty);
  280   2                      break;
  281   2      
  282   2              case PWM4:
  283   2                      PWMA_Duty4(PWMx->PWM4_Duty);
  284   2                      break;
  285   2      
  286   2              case PWM5:
  287   2                      PWMB_Duty5(PWMx->PWM5_Duty);
  288   2                      break;
  289   2      
  290   2              case PWM6:
  291   2                      PWMB_Duty6(PWMx->PWM6_Duty);
  292   2                      break;
  293   2      
  294   2              case PWM7:
  295   2                      PWMB_Duty7(PWMx->PWM7_Duty);
  296   2                      break;
  297   2      
  298   2              case PWM8:
  299   2                      PWMB_Duty8(PWMx->PWM8_Duty);
  300   2                      break;
  301   2      
  302   2              case PWMA:
  303   2                      PWMA_Duty1(PWMx->PWM1_Duty);
  304   2                      PWMA_Duty2(PWMx->PWM2_Duty);
  305   2                      PWMA_Duty3(PWMx->PWM3_Duty);
  306   2                      PWMA_Duty4(PWMx->PWM4_Duty);
  307   2                      break;
  308   2      
  309   2              case PWMB:
  310   2                      PWMB_Duty5(PWMx->PWM5_Duty);
  311   2                      PWMB_Duty6(PWMx->PWM6_Duty);
  312   2                      PWMB_Duty7(PWMx->PWM7_Duty);
  313   2                      PWMB_Duty8(PWMx->PWM8_Duty);
  314   2                      break;
  315   2              }
  316   1      }
  317          
  318          //========================================================================
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 6   

  319          // º¯Êý: UpdatePwm
  320          // ÃèÊö: PWMÕ¼¿Õ±È¸üÐÂ³ÌÐò.
  321          // ²ÎÊý: PWM: PWMÍ¨µÀ/Õ¼¿Õ±ÈÊ±¼ä
  322          // ·µ»Ø: none.
  323          // °æ±¾: V1.0, 2024-11-17
  324          //========================================================================
  325          void UpdatePwmCh(u8 PWM_CH, u16 Duty)
  326          {
  327   1              switch (PWM_CH)
  328   1              {
  329   2              case PWM1:
  330   2                      PWMA_Duty1(Duty);
  331   2                      break;
  332   2      
  333   2              case PWM2:
  334   2                      PWMA_Duty2(Duty);
  335   2                      break;
  336   2      
  337   2              case PWM3:
  338   2                      PWMA_Duty3(Duty);
  339   2                      break;
  340   2      
  341   2              case PWM4:
  342   2                      PWMA_Duty4(Duty);
  343   2                      break;
  344   2      
  345   2              case PWM5:
  346   2                      PWMB_Duty5(Duty);
  347   2                      break;
  348   2      
  349   2              case PWM6:
  350   2                      PWMB_Duty6(Duty);
  351   2                      break;
  352   2      
  353   2              case PWM7:
  354   2                      PWMB_Duty7(Duty);
  355   2                      break;
  356   2      
  357   2              case PWM8:
  358   2                      PWMB_Duty8(Duty);
  359   2                      break;
  360   2      
  361   2              case PWMA:
  362   2                      PWMA_Duty1(Duty);
  363   2                      PWMA_Duty2(Duty);
  364   2                      PWMA_Duty3(Duty);
  365   2                      PWMA_Duty4(Duty);
  366   2                      break;
  367   2      
  368   2              case PWMB:
  369   2                      PWMB_Duty5(Duty);
  370   2                      PWMB_Duty6(Duty);
  371   2                      PWMB_Duty7(Duty);
  372   2                      PWMB_Duty8(Duty);
  373   2                      break;
  374   2              }
  375   1      }
  376          
  377          //========================================================================
  378          // º¯Êý: ReadPWMA(void)
  379          // ÃèÊö: Òì²½¶ÁÈ¡PWMAÌØÊâ¹¦ÄÜ¼Ä´æÆ÷º¯Êý.
  380          // ²ÎÊý: addr: ¶ÁÈ¡ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µØÖ·.
  381          // ·µ»Ø: dat:  ¶ÁÈ¡ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷ÄÚÈÝ.
  382          // °æ±¾: V1.0, 2022-03-16
  383          //========================================================================
  384          u8 ReadPWMA(u8 addr)
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 7   

  385          {
  386   1              u8 dat;
  387   1      
  388   1              while (HSPWMA_ADR & 0x80)
  389   1                      ;                                         // µÈ´ýÇ°Ò»¸öÒì²½¶ÁÐ´Íê³É
  390   1              HSPWMA_ADR = addr | 0x80; // ÉèÖÃ¼ä½Ó·ÃÎÊµØÖ·,Ö»ÐèÒªÉèÖÃÔ­XFRµØÖ·µÄµÍ7Î»
  391   1                                                                // HSPWMA_ADDR¼Ä´æÆ÷µÄ×î¸ßÎ»Ð´1,±íÊ¾¶ÁÊý¾Ý
  392   1              while (HSPWMA_ADR & 0x80)
  393   1                      ;                         // µÈ´ýµ±Ç°Òì²½¶ÁÈ¡Íê³É
  394   1              dat = HSPWMA_DAT; // ¶ÁÈ¡Òì²½Êý¾Ý
  395   1      
  396   1              return dat;
  397   1      }
  398          
  399          //========================================================================
  400          // º¯Êý: ReadPWMB(void)
  401          // ÃèÊö: Òì²½¶ÁÈ¡PWMBÌØÊâ¹¦ÄÜ¼Ä´æÆ÷º¯Êý.
  402          // ²ÎÊý: addr: ¶ÁÈ¡ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µØÖ·.
  403          // ·µ»Ø: dat:  ¶ÁÈ¡ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷ÄÚÈÝ.
  404          // °æ±¾: V1.0, 2022-03-16
  405          //========================================================================
  406          u8 ReadPWMB(u8 addr)
  407          {
  408   1              u8 dat;
  409   1      
  410   1              while (HSPWMB_ADR & 0x80)
  411   1                      ;                                         // µÈ´ýÇ°Ò»¸öÒì²½¶ÁÐ´Íê³É
  412   1              HSPWMB_ADR = addr | 0x80; // ÉèÖÃ¼ä½Ó·ÃÎÊµØÖ·,Ö»ÐèÒªÉèÖÃÔ­XFRµØÖ·µÄµÍ7Î»
  413   1                                                                // HSPWMB_ADDR¼Ä´æÆ÷µÄ×î¸ßÎ»Ð´1,±íÊ¾¶ÁÊý¾Ý
  414   1              while (HSPWMB_ADR & 0x80)
  415   1                      ;                         // µÈ´ýµ±Ç°Òì²½¶ÁÈ¡Íê³É
  416   1              dat = HSPWMB_DAT; // ¶ÁÈ¡Òì²½Êý¾Ý
  417   1      
  418   1              return dat;
  419   1      }
  420          
  421          //========================================================================
  422          // º¯Êý: WritePWMA(void)
  423          // ÃèÊö: Òì²½¶ÁÈ¡PWMAÌØÊâ¹¦ÄÜ¼Ä´æÆ÷º¯Êý.
  424          // ²ÎÊý: addr: Ð´ÈëÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µØÖ·.
  425          // ²ÎÊý: dat:  Ð´ÈëÌØÊâ¹¦ÄÜ¼Ä´æÆ÷ÄÚÈÝ.
  426          // ·µ»Ø: none.
  427          // °æ±¾: V1.0, 2022-03-16
  428          //========================================================================
  429          void WritePWMA(u8 addr, u8 dat)
  430          {
  431   1              while (HSPWMA_ADR & 0x80)
  432   1                      ;                                         // µÈ´ýÇ°Ò»¸öÒì²½¶ÁÐ´Íê³É
  433   1              HSPWMA_DAT = dat;                 // ×¼±¸ÐèÒªÐ´ÈëµÄÊý¾Ý
  434   1              HSPWMA_ADR = addr & 0x7f; // ÉèÖÃ¼ä½Ó·ÃÎÊµØÖ·,Ö»ÐèÒªÉèÖÃÔ­XFRµØÖ·µÄµÍ7Î»
  435   1                                                                // HSPWMA_ADDR¼Ä´æÆ÷µÄ×î¸ßÎ»Ð´0,±íÊ¾Ð´Êý¾Ý
  436   1      }
  437          
  438          //========================================================================
  439          // º¯Êý: WritePWMB(void)
  440          // ÃèÊö: Òì²½¶ÁÈ¡PWMBÌØÊâ¹¦ÄÜ¼Ä´æÆ÷º¯Êý.
  441          // ²ÎÊý: addr: Ð´ÈëÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µØÖ·.
  442          // ²ÎÊý: dat:  Ð´ÈëÌØÊâ¹¦ÄÜ¼Ä´æÆ÷ÄÚÈÝ.
  443          // ·µ»Ø: none.
  444          // °æ±¾: V1.0, 2022-03-16
  445          //========================================================================
  446          void WritePWMB(u8 addr, u8 dat)
  447          {
  448   1              while (HSPWMB_ADR & 0x80)
  449   1                      ;                                         // µÈ´ýÇ°Ò»¸öÒì²½¶ÁÐ´Íê³É
  450   1              HSPWMB_DAT = dat;                 // ×¼±¸ÐèÒªÐ´ÈëµÄÊý¾Ý
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 8   

  451   1              HSPWMB_ADR = addr & 0x7f; // ÉèÖÃ¼ä½Ó·ÃÎÊµØÖ·,Ö»ÐèÒªÉèÖÃÔ­XFRµØÖ·µÄµÍ7Î»
  452   1                                                                // HSPWMB_ADDR¼Ä´æÆ÷µÄ×î¸ßÎ»Ð´0,±íÊ¾Ð´Êý¾Ý
  453   1      }
  454          
  455          //========================================================================
  456          // º¯Êý: HSPWM_Configuration
  457          // ÃèÊö: HSPWM³õÊ¼»¯³ÌÐò.
  458          // ²ÎÊý: PWMx: ½á¹¹²ÎÊý,Çë²Î¿¼PWM.hÀïµÄ¶¨Òå.
  459          // ·µ»Ø: ³É¹¦·µ»Ø SUCCESS, ´íÎó·µ»Ø FAIL.
  460          // °æ±¾: V1.0, 2022-04-05
  461          //========================================================================
  462          void HSPWM_Configuration(u8 PWM, HSPWMx_InitDefine *PWMx, PWMx_Duty *DUTYx)
  463          {
  464   1              u8 tmpENO, tmpCCER1, tmpCCER2;
  465   1      
  466   1              if (PWM == PWMA)
  467   1              {
  468   2                      HSPWMA_CFG = 0x03; // Ê¹ÄÜPWMAÏà¹Ø¼Ä´æÆ÷Òì²½·ÃÎÊ¹¦ÄÜ
  469   2      
  470   2                      if (PWMx->PWM_EnoSelect & ENO1P)
  471   2                      {
  472   3                              tmpENO |= ENO1P;
  473   3                              tmpCCER1 |= 0x01;
  474   3                      }
  475   2                      else
  476   2                      {
  477   3                              tmpENO &= ~ENO1P;
  478   3                              tmpCCER1 &= ~0x01;
  479   3                      }
  480   2                      if (PWMx->PWM_EnoSelect & ENO1N)
  481   2                      {
  482   3                              tmpENO |= ENO1N;
  483   3                              tmpCCER1 |= 0x04;
  484   3                      }
  485   2                      else
  486   2                      {
  487   3                              tmpENO &= ~ENO1N;
  488   3                              tmpCCER1 &= ~0x04;
  489   3                      }
  490   2                      if (PWMx->PWM_EnoSelect & ENO2P)
  491   2                      {
  492   3                              tmpENO |= ENO2P;
  493   3                              tmpCCER1 |= 0x10;
  494   3                      }
  495   2                      else
  496   2                      {
  497   3                              tmpENO &= ~ENO2P;
  498   3                              tmpCCER1 &= ~0x10;
  499   3                      }
  500   2                      if (PWMx->PWM_EnoSelect & ENO2N)
  501   2                      {
  502   3                              tmpENO |= ENO2N;
  503   3                              tmpCCER1 |= 0x40;
  504   3                      }
  505   2                      else
  506   2                      {
  507   3                              tmpENO &= ~ENO2N;
  508   3                              tmpCCER1 &= ~0x40;
  509   3                      }
  510   2                      if (PWMx->PWM_EnoSelect & ENO3P)
  511   2                      {
  512   3                              tmpENO |= ENO3P;
  513   3                              tmpCCER2 |= 0x01;
  514   3                      }
  515   2                      else
  516   2                      {
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 9   

  517   3                              tmpENO &= ~ENO3P;
  518   3                              tmpCCER2 &= ~0x01;
  519   3                      }
  520   2                      if (PWMx->PWM_EnoSelect & ENO3N)
  521   2                      {
  522   3                              tmpENO |= ENO3N;
  523   3                              tmpCCER2 |= 0x04;
  524   3                      }
  525   2                      else
  526   2                      {
  527   3                              tmpENO &= ~ENO3N;
  528   3                              tmpCCER2 &= ~0x04;
  529   3                      }
  530   2                      if (PWMx->PWM_EnoSelect & ENO4P)
  531   2                      {
  532   3                              tmpENO |= ENO4P;
  533   3                              tmpCCER2 |= 0x10;
  534   3                      }
  535   2                      else
  536   2                      {
  537   3                              tmpENO &= ~ENO4P;
  538   3                              tmpCCER2 &= ~0x10;
  539   3                      }
  540   2                      if (PWMx->PWM_EnoSelect & ENO4N)
  541   2                      {
  542   3                              tmpENO |= ENO4N;
  543   3                              tmpCCER2 |= 0x40;
  544   3                      }
  545   2                      else
  546   2                      {
  547   3                              tmpENO &= ~ENO4N;
  548   3                              tmpCCER2 &= ~0x40;
  549   3                      }
  550   2      
  551   2                      // Í¨¹ýÒì²½·½Ê½ÉèÖÃPWMAµÄÏà¹Ø¼Ä´æÆ÷
  552   2                      WritePWMA((u8)&PWMA_CCER1, 0x00);
  553   2                      WritePWMA((u8)&PWMA_CCER2, 0x00);
  554   2                      WritePWMA((u8)&PWMA_CCMR1, CCMRn_PWM_MODE1); // Í¨µÀÄ£Ê½ÅäÖÃ
  555   2                      WritePWMA((u8)&PWMA_CCMR2, CCMRn_PWM_MODE1);
  556   2                      WritePWMA((u8)&PWMA_CCMR3, CCMRn_PWM_MODE1);
  557   2                      WritePWMA((u8)&PWMA_CCMR4, CCMRn_PWM_MODE1);
  558   2                      WritePWMA((u8)&PWMA_CCER1, tmpCCER1); // ÅäÖÃÍ¨µÀÊä³öÊ¹ÄÜºÍ¼«ÐÔ
  559   2                      WritePWMA((u8)&PWMA_CCER2, tmpCCER2);
  560   2                      WritePWMA((u8)&PWMA_ENO, tmpENO);                                                // Ê¹ÄÜPWMÐÅºÅÊä³ö¶Ë¿Ú
  561   2                      WritePWMA((u8)&PWMA_CCR1H, (u8)(DUTYx->PWM1_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  562   2                      WritePWMA((u8)&PWMA_CCR1L, (u8)DUTYx->PWM1_Duty);
  563   2                      WritePWMA((u8)&PWMA_CCR2H, (u8)(DUTYx->PWM2_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  564   2                      WritePWMA((u8)&PWMA_CCR2L, (u8)DUTYx->PWM2_Duty);
  565   2                      WritePWMA((u8)&PWMA_CCR3H, (u8)(DUTYx->PWM3_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  566   2                      WritePWMA((u8)&PWMA_CCR3L, (u8)DUTYx->PWM3_Duty);
  567   2                      WritePWMA((u8)&PWMA_CCR4H, (u8)(DUTYx->PWM4_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  568   2                      WritePWMA((u8)&PWMA_CCR4L, (u8)DUTYx->PWM4_Duty);
  569   2                      WritePWMA((u8)&PWMA_ARRH, (u8)(PWMx->PWM_Period >> 8)); // ÉèÖÃÊä³öPWMµÄÖÜÆÚ
  570   2                      WritePWMA((u8)&PWMA_ARRL, (u8)(PWMx->PWM_Period));
  571   2                      WritePWMA((u8)&PWMA_DTR, PWMx->PWM_DeadTime);                   // ÉèÖÃ»¥²¹¶Ô³ÆÊä³öPWMµÄËÀÇø
  572   2                      WritePWMA((u8)&PWMA_BKR, PWMx->PWM_MainOutEnable << 7); // Ê¹ÄÜÖ÷Êä³ö
  573   2                      WritePWMA((u8)&PWMA_CR1, PWMx->PWM_CEN_Enable);                 // ¿ªÊ¼PWM¼ÆÊý
  574   2              }
  575   1              else if (PWM == PWMB)
  576   1              {
  577   2                      HSPWMB_CFG = 0x03; // Ê¹ÄÜPWMBÏà¹Ø¼Ä´æÆ÷Òì²½·ÃÎÊ¹¦ÄÜ
  578   2      
  579   2                      if (PWMx->PWM_EnoSelect & ENO5P)
  580   2                      {
  581   3                              tmpENO |= ENO5P;
  582   3                              tmpCCER1 |= 0x01;
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 10  

  583   3                      }
  584   2                      else
  585   2                      {
  586   3                              tmpENO &= ~ENO5P;
  587   3                              tmpCCER1 &= ~0x01;
  588   3                      }
  589   2                      if (PWMx->PWM_EnoSelect & ENO6P)
  590   2                      {
  591   3                              tmpENO |= ENO6P;
  592   3                              tmpCCER1 |= 0x10;
  593   3                      }
  594   2                      else
  595   2                      {
  596   3                              tmpENO &= ~ENO6P;
  597   3                              tmpCCER1 &= ~0x10;
  598   3                      }
  599   2                      if (PWMx->PWM_EnoSelect & ENO7P)
  600   2                      {
  601   3                              tmpENO |= ENO7P;
  602   3                              tmpCCER2 |= 0x01;
  603   3                      }
  604   2                      else
  605   2                      {
  606   3                              tmpENO &= ~ENO7P;
  607   3                              tmpCCER2 &= ~0x01;
  608   3                      }
  609   2                      if (PWMx->PWM_EnoSelect & ENO8P)
  610   2                      {
  611   3                              tmpENO |= ENO8P;
  612   3                              tmpCCER2 |= 0x10;
  613   3                      }
  614   2                      else
  615   2                      {
  616   3                              tmpENO &= ~ENO8P;
  617   3                              tmpCCER2 &= ~0x10;
  618   3                      }
  619   2      
  620   2                      // Í¨¹ýÒì²½·½Ê½ÉèÖÃPWMBµÄÏà¹Ø¼Ä´æÆ÷
  621   2                      WritePWMB((u8)&PWMB_CCER1, 0x00);
  622   2                      WritePWMB((u8)&PWMB_CCER2, 0x00);
  623   2                      WritePWMB((u8)&PWMB_CCMR1, CCMRn_PWM_MODE1); // Í¨µÀÄ£Ê½ÅäÖÃ
  624   2                      WritePWMB((u8)&PWMB_CCMR2, CCMRn_PWM_MODE1);
  625   2                      WritePWMB((u8)&PWMB_CCMR3, CCMRn_PWM_MODE1);
  626   2                      WritePWMB((u8)&PWMB_CCMR4, CCMRn_PWM_MODE1);
  627   2                      WritePWMB((u8)&PWMB_CCER1, tmpCCER1); // ÅäÖÃÍ¨µÀÊä³öÊ¹ÄÜºÍ¼«ÐÔ
  628   2                      WritePWMB((u8)&PWMB_CCER2, tmpCCER2);
  629   2                      WritePWMB((u8)&PWMB_ENO, tmpENO);                                                // Ê¹ÄÜPWMÐÅºÅÊä³ö¶Ë¿Ú
  630   2                      WritePWMB((u8)&PWMB_CCR5H, (u8)(DUTYx->PWM5_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  631   2                      WritePWMB((u8)&PWMB_CCR5L, (u8)DUTYx->PWM5_Duty);
  632   2                      WritePWMB((u8)&PWMB_CCR6H, (u8)(DUTYx->PWM6_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  633   2                      WritePWMB((u8)&PWMB_CCR6L, (u8)DUTYx->PWM6_Duty);
  634   2                      WritePWMB((u8)&PWMB_CCR7H, (u8)(DUTYx->PWM7_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  635   2                      WritePWMB((u8)&PWMB_CCR7L, (u8)DUTYx->PWM7_Duty);
  636   2                      WritePWMB((u8)&PWMB_CCR8H, (u8)(DUTYx->PWM8_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  637   2                      WritePWMB((u8)&PWMB_CCR8L, (u8)DUTYx->PWM8_Duty);
  638   2                      WritePWMB((u8)&PWMB_ARRH, (u8)(PWMx->PWM_Period >> 8)); // ÉèÖÃÊä³öPWMµÄÖÜÆÚ
  639   2                      WritePWMB((u8)&PWMB_ARRL, (u8)(PWMx->PWM_Period));
  640   2                      WritePWMB((u8)&PWMB_DTR, PWMx->PWM_DeadTime);                   // ÉèÖÃ»¥²¹¶Ô³ÆÊä³öPWMµÄËÀÇø
  641   2                      WritePWMB((u8)&PWMB_BKR, PWMx->PWM_MainOutEnable << 7); // Ê¹ÄÜÖ÷Êä³ö
  642   2                      WritePWMB((u8)&PWMB_CR1, PWMx->PWM_CEN_Enable);                 // ¿ªÊ¼PWM¼ÆÊý
  643   2              }
  644   1      }
  645          
  646          //========================================================================
  647          // º¯Êý: UpdateHSPwm
  648          // ÃèÊö: HSPWMÕ¼¿Õ±È¸üÐÂ³ÌÐò.
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 11  

  649          // ²ÎÊý: PWM: PWMÍ¨µÀ/×éºÅ, PWMx½á¹¹²ÎÊý,Çë²Î¿¼PWM.hÀïµÄ¶¨Òå.
  650          // ·µ»Ø: none.
  651          // °æ±¾: V1.0, 2022-04-05
  652          //========================================================================
  653          void UpdateHSPwm(u8 PWM, PWMx_Duty *PWMx)
  654          {
  655   1              switch (PWM)
  656   1              {
  657   2              case PWM1:
  658   2                      WritePWMA((u8)&PWMA_CCR1H, (u8)(PWMx->PWM1_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  659   2                      WritePWMA((u8)&PWMA_CCR1L, (u8)PWMx->PWM1_Duty);
  660   2                      break;
  661   2      
  662   2              case PWM2:
  663   2                      WritePWMA((u8)&PWMA_CCR2H, (u8)(PWMx->PWM2_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  664   2                      WritePWMA((u8)&PWMA_CCR2L, (u8)PWMx->PWM2_Duty);
  665   2                      break;
  666   2      
  667   2              case PWM3:
  668   2                      WritePWMA((u8)&PWMA_CCR3H, (u8)(PWMx->PWM3_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  669   2                      WritePWMA((u8)&PWMA_CCR3L, (u8)PWMx->PWM3_Duty);
  670   2                      break;
  671   2      
  672   2              case PWM4:
  673   2                      WritePWMA((u8)&PWMA_CCR4H, (u8)(PWMx->PWM4_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  674   2                      WritePWMA((u8)&PWMA_CCR4L, (u8)PWMx->PWM4_Duty);
  675   2                      break;
  676   2      
  677   2              case PWM5:
  678   2                      WritePWMB((u8)&PWMB_CCR5H, (u8)(PWMx->PWM5_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  679   2                      WritePWMB((u8)&PWMB_CCR5L, (u8)PWMx->PWM5_Duty);
  680   2                      break;
  681   2      
  682   2              case PWM6:
  683   2                      WritePWMB((u8)&PWMB_CCR6H, (u8)(PWMx->PWM6_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  684   2                      WritePWMB((u8)&PWMB_CCR6L, (u8)PWMx->PWM6_Duty);
  685   2                      break;
  686   2      
  687   2              case PWM7:
  688   2                      WritePWMB((u8)&PWMB_CCR7H, (u8)(PWMx->PWM7_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  689   2                      WritePWMB((u8)&PWMB_CCR7L, (u8)PWMx->PWM7_Duty);
  690   2                      break;
  691   2      
  692   2              case PWM8:
  693   2                      WritePWMB((u8)&PWMB_CCR8H, (u8)(PWMx->PWM8_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  694   2                      WritePWMB((u8)&PWMB_CCR8L, (u8)PWMx->PWM8_Duty);
  695   2                      break;
  696   2      
  697   2              case PWMA:
  698   2                      WritePWMA((u8)&PWMA_CCR1H, (u8)(PWMx->PWM1_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  699   2                      WritePWMA((u8)&PWMA_CCR1L, (u8)PWMx->PWM1_Duty);
  700   2                      WritePWMA((u8)&PWMA_CCR2H, (u8)(PWMx->PWM2_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  701   2                      WritePWMA((u8)&PWMA_CCR2L, (u8)PWMx->PWM2_Duty);
  702   2                      WritePWMA((u8)&PWMA_CCR3H, (u8)(PWMx->PWM3_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  703   2                      WritePWMA((u8)&PWMA_CCR3L, (u8)PWMx->PWM3_Duty);
  704   2                      WritePWMA((u8)&PWMA_CCR4H, (u8)(PWMx->PWM4_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  705   2                      WritePWMA((u8)&PWMA_CCR4L, (u8)PWMx->PWM4_Duty);
  706   2                      break;
  707   2      
  708   2              case PWMB:
  709   2                      WritePWMB((u8)&PWMB_CCR5H, (u8)(PWMx->PWM5_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  710   2                      WritePWMB((u8)&PWMB_CCR5L, (u8)PWMx->PWM5_Duty);
  711   2                      WritePWMB((u8)&PWMB_CCR6H, (u8)(PWMx->PWM6_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  712   2                      WritePWMB((u8)&PWMB_CCR6L, (u8)PWMx->PWM6_Duty);
  713   2                      WritePWMB((u8)&PWMB_CCR7H, (u8)(PWMx->PWM7_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  714   2                      WritePWMB((u8)&PWMB_CCR7L, (u8)PWMx->PWM7_Duty);
C251 COMPILER V5.60.0,  AI8051U_PWM                                                        18/11/25  13:07:44  PAGE 12  

  715   2                      WritePWMB((u8)&PWMB_CCR8H, (u8)(PWMx->PWM8_Duty >> 8)); // ÉèÖÃÊä³öPWMµÄÕ¼¿Õ±È
  716   2                      WritePWMB((u8)&PWMB_CCR8L, (u8)PWMx->PWM8_Duty);
  717   2                      break;
  718   2              }
  719   1      }
  720          
  721          
*** WARNING C184 IN LINE 472 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpENO' possibly undefined
*** WARNING C184 IN LINE 473 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER1' possibly undefined
*** WARNING C184 IN LINE 477 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpENO' possibly undefined
*** WARNING C184 IN LINE 478 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER1' possibly undefined
*** WARNING C184 IN LINE 513 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER2' possibly undefined
*** WARNING C184 IN LINE 518 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER2' possibly undefined
*** WARNING C184 IN LINE 581 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpENO' possibly undefined
*** WARNING C184 IN LINE 582 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER1' possibly undefined
*** WARNING C184 IN LINE 586 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpENO' possibly undefined
*** WARNING C184 IN LINE 587 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER1' possibly undefined
*** WARNING C184 IN LINE 602 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER2' possibly undefined
*** WARNING C184 IN LINE 607 OF ..\lq_libraries\Driver\Src\AI8051U_PWM.c: value of 'tmpCCER2' possibly undefined


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      3903     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------          7
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  12 WARNING(S),  0 ERROR(S)
