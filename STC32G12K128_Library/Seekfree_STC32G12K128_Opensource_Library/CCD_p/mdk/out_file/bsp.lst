C251 COMPILER V5.60.0,  bsp                                                                19/11/25  22:33:07  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE bsp
OBJECT MODULE PLACED IN .\out_file\bsp.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\code\bsp.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BROWSE 
                    -INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;..\us
                    -er;..\code;..\Hardware) DEBUG PRINT(.\out_file\bsp.lst) OBJECT(.\out_file\bsp.obj) 

stmt  level    source

    1          #include "bsp.h"
    2          
    3          
    4          uint8 task_num=0;
    5          
    6          typedef struct scheduler
    7          {
    8              void(*task_func)(void);
    9              uint32 rate_ms;
   10              uint32 last_run;
   11          }scheduler_task_t;
   12          
   13          static scheduler_task_t scheduler_task[]={
   14            {led_process,1,0},
   15            {self_UART_process,1,0},
   16          //  {Servo_test_Process,1,0},
   17            //{Self_LCD_Progress,10,0}
   18            };  //1表示10ms
   19          
   20          //初始化
   21          void scheduler_Init(void)
   22          {
   23   1          task_num=sizeof(scheduler_task)/sizeof(scheduler_task_t);
   24   1      }
   25          
   26          void all_init(void)
   27          {
   28   1          //底层初始化
   29   1          clock_init(SYSTEM_CLOCK_30M);
   30   1              debug_init();
   31   1          //gpio_init(LED1, GPO, GPIO_LOW, GPO_PUSH_PULL);
   32   1          //scheduler_Init();
   33   1          LCD_gpio_Init();
   34   1          //用户初始化
   35   1          self_pit_init();
   36   1          self_UART_init();
   37   1          //IIC_intit();
   38   1          Servo_init();
   39   1          
   40   1      }
   41          
   42          
   43          //执行任务表
   44             //hal_tick函数不更新容易卡
   45          
   46          void scheduler_run(void)
   47          {
   48   1          int i;
   49   1          for(i=0;i<task_num;i++)
   50   1          {
   51   2            uint32 Now_Time=pit_read();
   52   2              
   53   2              if(Now_Time>=scheduler_task[i].rate_ms+scheduler_task[i].last_run)
   54   2              {
   55   3                  scheduler_task[i].last_run=Now_Time;
   56   3                  //更新最后时间
   57   3                  scheduler_task[i].task_func();
C251 COMPILER V5.60.0,  bsp                                                                19/11/25  22:33:07  PAGE 2   

   58   3                  //执行相应代码
   59   3              }
   60   2          }
   61   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       161     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =        21          4
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        31     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
