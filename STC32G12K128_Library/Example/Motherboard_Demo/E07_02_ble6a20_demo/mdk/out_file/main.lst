C251 COMPILER V5.60.0,  main                                                               10/11/25  12:51:00  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE main
OBJECT MODULE PLACED IN .\out_file\main.obj
COMPILER INVOKED BY: D:\MDK\C251\BIN\C251.EXE ..\user\main.c LARGE NOALIAS FLOAT64 WARNINGLEVEL(3) OPTIMIZE(SIZE) BROWSE
                    - INCDIR(..\..\libraries\zf_common;..\..\libraries\zf_components;..\..\libraries\zf_device;..\..\libraries\zf_driver;..\u
                    -ser;..\code) DEBUG PRINT(.\out_file\main.lst) OBJECT(.\out_file\main.obj) 

stmt  level    source

    1          /********************************************************************************************************
             -*************
    2          * STC32G Opensourec Library 即（STC32G 开源库）是一个基于官方 SDK 接口的第三方开源
             -
    3          * Copyright (c) 2022 SEEKFREE 逐飞科技
    4          *
    5          * 本文件是STC 开源库的一部分
    6          *
    7          * STC32G 开源库 是免费软件
    8          * 您可以根据自由软件基金会发布的 GPL（GNU General Public License，即 GNU通用公共许
             -可证）的条款
    9          * 即 GPL 的第3版（即 GPL3.0）或（您选择的）任何后来的版本，重新发布和/或修
             -它
   10          *
   11          * 本开源库的发布是希望它能发挥作用，但并未对其作任何的保证
   12          * 甚至没有隐含的适销性或适合特定用途的保证
   13          * 更多细节请参见 GPL
   14          *
   15          * 您应该在收到本开源库的同时收到一份 GPL 的副本
   16          * 如果没有，请参阅<https://www.gnu.org/licenses/>
   17          *
   18          * 额外注明：
   19          * 本开源库使用 GPL3.0 开源许可证协议 以上许可申明为译文版本
   20          * 许可申明英文版在 libraries/doc 文件夹下的 GPL3_permission_statement.txt 文件中
   21          * 许可证副本在 libraries 文件夹下 即该文件夹下的 LICENSE 文件
   22          * 欢迎各位使用并传播本程序 但修改内容时必须保留逐飞科技的版权声明（即本
             -声明）
   23          *
   24          * 文件名称          
   25          * 公司名称          成都逐飞科技有限公司
   26          * 版本信息          查看 libraries/doc 文件夹内 version 文件 版本说明
   27          * 开发环境          MDK FOR C251
   28          * 适用平台          STC32G
   29          * 店铺链接          https://seekfree.taobao.com/
   30          *
   31          * 修改记录
   32          * 日期              作者           备注
   33          * 2024-08-01        大W            first version
   34          *********************************************************************************************************
             -***********/
   35          
   36          #include "zf_common_headfile.h"
   37          
   38          // *************************** 例程硬件连接说明 ***************************
   39          // 接入蓝牙转串口模块
   40          //      模块管脚            单片机管脚
   41          //      RX                  查看 zf_device_ble6a20.h 中BLE6A20_RX_PIN  宏定义
   42          //      TX                  查看 zf_device_ble6a20.h 中BLE6A20_TX_PIN  宏定义
   43          //      RTS                 查看 zf_device_ble6a20.h 中BLE6A20_RTS_PIN 宏定义
   44          //      GND                 核心板电源地 GND
   45          //      3V3                 核心板 3V3 电源
   46          
   47          // *************************** 例程测试说明 ***************************
   48          // 1.核心板烧录完成本例程
   49          //
   50          // 2.如果使用主板测试 在断电情况下 将核心板插入主板 蓝牙转串口模块插入主
             -蓝牙模块接口
C251 COMPILER V5.60.0,  main                                                               10/11/25  12:51:00  PAGE 2   

   51          //
   52          // 3.如果使用核心板和模块测试 在断电情况下 将核心板与蓝牙模块连接
   53          //
   54          // 4.通过PC打开蓝牙转串口 USB端的串口  串口波特率为 zf_device_ble6a20.h 文件中BLE6A
             -20_BUAD_RATE 宏定义 默认 115200，核心板按下复位按键
   55          //
   56          // 5.单片机上电复位后 可以在串口助手上看到如下串口信息：
   57          //      SEEKFREE BLE6A20 DEMO.
   58          //
   59          // 6.串口助手发送数据会收到回复消息
   60          //
   61          // 如果发现现象与说明严重不符 请参照本文件最下方 例程常见问题说明 进行排
             -查
   62          
   63          // **************************** 代码区域 ****************************
   64          #define LED1                    (IO_P52 )
   65          
   66          uint8 data_buffer[32];
   67          uint8 data_len;
   68          uint8 count = 0;
   69                          
   70          void main()
   71          {
   72   1          clock_init(SYSTEM_CLOCK_30M);
   73   1              debug_init();
   74   1              
   75   1              gpio_init(LED1, GPO, GPIO_HIGH, GPO_PUSH_PULL);                             // 初始化 LED1 输出 默
             -认高电平 推挽输出模式
   76   1          while(ble6a20_init())                                                       // 判断是否通过初
             -化
   77   1          {
   78   2              gpio_toggle_level(LED1);                                                // 翻转 LED 引脚输
             -电平 控制 LED 亮灭
   79   2              system_delay_ms(100);                                                   // 短延时快速闪灯
             -示异常
   80   2      
   81   2              printf("ble6a20 init error.\r\n");
   82   2              printf("restart ble6a20 init.\r\n");
   83   2          }
   84   1          ble6a20_send_byte('\r');
   85   1          ble6a20_send_byte('\n');
   86   1          ble6a20_send_string("SEEKFREE BLE6A20 DEMO.\r\n");                    // 初始化正常 输出测试
             -信息
   87   1          // 此处编写用户代码 例如外设初始化代码等
   88   1      
   89   1          while(1)
   90   1          {
   91   2              // 此处编写需要循环执行的代码
   92   2              data_len = ble6a20_read_buffer(data_buffer, 32);                            // 查看是否有消
             -息 默认缓冲区是BLE6A20_BUFFER_SIZE 总共 64 字节
   93   2              if(data_len != 0)                                                           // 收到了消息 
             -取函数会返回实际读取到的数据个数
   94   2              {
   95   3                  ble6a20_send_buffer(data_buffer, data_len);                             // 将收到的消息
             -发送回去
   96   3                  ble6a20_send_string("\r\n");
   97   3                  memset(data_buffer, 0, 32);
   98   3                  func_uint_to_str((char *)data_buffer, data_len);
   99   3                  ble6a20_send_string("data len:");                                       // 显示实际收到
             -的数据信息
  100   3                  ble6a20_send_buffer(data_buffer, strlen((const char *)data_buffer));    // 显示收到的数
             -据个数
  101   3                  ble6a20_send_string(".\r\n");
  102   3                  gpio_toggle_level(LED1);
  103   3              }
  104   2              system_delay_ms(100);
C251 COMPILER V5.60.0,  main                                                               10/11/25  12:51:00  PAGE 3   

  105   2              // 此处编写需要循环执行的代码
  106   2          }
  107   1      }
  108          // **************************** 代码区域 ****************************
  109          
  110          // *************************** 例程常见问题说明 ***************************
  111          // 遇到问题时请按照以下问题检查列表检查
  112          //
  113          // 问题1：串口没有数据
  114          //      查看串口助手打开的是否是正确的串口，检查打开的 COM 口是否对应的是 
             -牙转串口 的 COM 口
  115          //      查看核心板LED灯状态 如果快速闪烁证明初始化失败 检查接线 或者按照说
             -书检查模块是否正常
  116          //
  117          // 问题2：串口数据乱码
  118          //      查看是否模块波特率被修改过 恢复出厂设置
  119          //
  120          // 问题3：发送数据没有收到回复
  121          //      按照说明书检查模块是否正常
  122          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       282     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =        34     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        96     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
